<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDOM - Simple SDL Document Object Model: Project Description and Development Progress</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SDOM - Simple SDL Document Object Model
   </div>
   <div id="projectbrief">A lightweight, extensible Document Object Model for SDL-based applications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_docs_2progress.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Project Description and Development Progress </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md334"></a></p>
<p><a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> is a C++23 library built on SDL3 that brings a DOM‑like scene graph and GUI toolkit to 2D applications and games. The aim is a small, predictable core for layout, events, and rendering so SDL developers can compose interfaces and in‑game UI with familiar patterns and a minimal API surface.</p>
<p>Architecturally, a single Core orchestrates the SDL runtime (window, renderer, main loop). A Stage serves as the root of the display tree, while an EventManager dispatches input through capture → target → bubble phases. The Factory registers, creates, and tracks resources and display objects by type and unique name, returning typed handles for safe references. Layout is driven by an edge‑based anchoring system that supports asymmetric, responsive designs.</p>
<p>Scripting and configuration are first‑class with Lua via Sol2 to enable data‑driven scenes, rapid iteration, and test automation. You can also build everything directly in C++—Lua is optional—but when enabled it can construct objects, wire scenes, drive dialog, and swap stages at runtime without recompilation.</p>
<p>The project emphasizes clear, living documentation. The Markdown design docs are working papers that evolve with the code. Expect them to change as features land and APIs are refined. Public APIs are defined in headers and surfaced via Doxygen, with correctness exercised by unit tests; if a doc briefly diverges from current behavior, treat the code as source‑of‑truth until the docs catch up. Diagrams are authored in Mermaid and exported to static SVG/PNG by the repo’s export pipeline, keeping visuals portable while ensuring the sources remain easy to edit. Progress updates will call out notable documentation changes, and contributions to clarify or correct docs are welcome.</p>
<p>This page is the hub for progress. The “Progress Updates” below record milestones chronologically with context and notes; the “Next Steps” and “ToDo” sections outline near‑term priorities and open tracks. Check back to see what landed and what’s coming next—and feel free to open issues or proposals as the API stabilizes.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md335"></a>
Scripting and Configuration</h1>
<p>Lua (via Sol2) is first‑class but optional—you can script scenes and behavior in Lua, build everything in C++, or mix both. The Factory accepts <span class="tt">sol::table</span> configs alongside initializer structs, and Core’s lifecycle hooks make it easy to integrate scripts for iteration and tests. See the dedicated design doc for details and examples: <a class="el" href="md_docs_2scripting__and__configuration.html">Scripting and Configuration (Lua + C++)</a>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md336"></a>
Progress Updates</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md337"></a>
[July 2, 2025]</h2>
<ul>
<li>Initial rough draft and proof of concept.</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md339"></a>
[August 5, 2025]</h2>
<ul>
<li><a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> secondary rough draft</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md341"></a>
[September 19, 2025]</h2>
<ul>
<li>Proof of concept approved. Main development approved. Work begins officially.</li>
<li>Improved Doxygen documentation for all major headers and macros.</li>
<li>Added and refined Doxygen comments for <a class="el" href="SDOM__CLR_8hpp.html" title="Static container for ANSI escape sequences for terminal text formatting and colorization.">SDOM_CLR.hpp</a>, <a class="el" href="SDOM_8hpp.html">SDOM.hpp</a>, and <a class="el" href="SDOM__IDataObject_8hpp.html">SDOM_IDataObject.hpp</a>.</li>
<li>Grouped and documented interface methods in SDOM_IDataObject for clarity and API usability.</li>
<li>Updated build script to run Doxygen from the correct folder, ensuring documentation builds reliably.</li>
<li>Fixed Doxyfile issues (footer path, PROJECT_BRIEF syntax) for clean documentation generation.</li>
<li>Validated Doxygen output for class, group, and member documentation.</li>
<li><span class="tt">IDataObject</span> designed. This base interface class handles JSON parsing and serialization.</li>
<li>Core class scaffold implemented as a thread-safe singleton.</li>
<li>Core initializes SDL, window, renderer, and texture with correct sizing and color from config.</li>
<li>Window and renderer display with correct logical size and background color.</li>
<li>Configuration via struct, JSON string, and JSON file is working and uses sensible defaults.</li>
<li>Main loop, event polling, and error handling are scaffolded and ready for extension.</li>
<li>Added six callback/hook registration methods to <span class="tt">Core</span>: <span class="tt">registerOnInit()</span>, <span class="tt">registerOnQuit()</span>, <span class="tt">registerOnUpdate()</span>, <span class="tt">registerOnEvent()</span>, <span class="tt">registerOnRender()</span>, <span class="tt">registerOnUnitTest()</span>.</li>
<li>Callbacks are invoked at the appropriate lifecycle and event points, enabling user-defined logic for initialization, quitting, updating, event handling, rendering, and unit testing.</li>
<li>Added <span class="tt">preserveAspectRatio</span> and <span class="tt">allowTextureResize</span> flags to <span class="tt">CoreConfig</span> for flexible window/texture resizing.</li>
<li>Window resizing now supports two modes: aspect ratio preservation and free resizing, controlled by config.</li>
<li>Texture resizing can be disabled via config, allowing fixed-resolution rendering regardless of window size.</li>
<li>JSON configuration supports both new flags for runtime flexibility.</li>
<li>Refined aspect ratio logic to use a static float for original aspect ratio, ensuring accuracy during repeated resizing.</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md343"></a>
[September 20, 2025]</h2>
<ul>
<li>Factory and resource_ptr scaffolding completed; code compiles and runs cleanly.</li>
<li>Event system foundation implemented and documented.</li>
<li>Doxygen documentation added for major interfaces (Core, Factory, IResourceObject).</li>
<li>Example usage of Core and Factory included in documentation.</li>
<li>Circular include and pointer management issues resolved (raw pointer for Factory ownership).</li>
<li>The <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> framework now has a working Core singleton, Factory resource management, and resource_ptr smart handle. The codebase is stable, maintainable, and ready for expanded testing and feature development.</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md345"></a>
[September 21, 2025]</h2>
<ul>
<li>Renamed <span class="tt">resource_ptr</span> to <span class="tt">ResourceHandle</span> throughout the codebase for clarity.<ul>
<li>The new name better reflects its role as an opaque handle or key for resource lookup, rather than a smart pointer with ownership semantics.</li>
<li>Updated all documentation, examples, and comments to use <span class="tt">ResourceHandle</span>.</li>
</ul>
</li>
<li>Factory resource management and <span class="tt">ResourceHandle</span> logic fully tested and confirmed:<ul>
<li>Resources can be added, retrieved, and removed from the Factory.</li>
<li>Multiple <span class="tt">ResourceHandle</span> instances correctly reflect resource existence and become invalid after removal.</li>
<li>Type-safe access via <span class="tt">dynamic_cast</span> is working and robust.</li>
</ul>
</li>
<li>Debug output and test scaffolding added to verify resource lifetime and pointer behavior.</li>
<li>Resolved copy constructor and assignment operator issues for <span class="tt">ResourceHandle</span>.</li>
<li>Confirmed that the Factory now contains a working <span class="tt">Stage</span> resource.</li>
<li>Next step: Implement parent/child relationships for resources and display objects.</li>
<li>Unit test framework will be moved to <span class="tt">onUnitTest()</span> methods once implemented.</li>
<li><b>Resource Creation &amp; Initialization:</b><ul>
<li>Verified that resources (especially Stage) are created via the Factory and properly initialized with onInit().</li>
<li>Debug output confirms lifecycle methods (onInit, onQuit, onUpdate, onRender) are called for the root stage.</li>
</ul>
</li>
<li><b>Core &amp; Factory Integration:</b><ul>
<li>Ensured the root node (mainStage) is set and found by Core, with correct debug output.</li>
<li>Improved resource creation logic to always use Factory::create, guaranteeing initialization and registration.</li>
</ul>
</li>
<li><b>Recursive Traversal:</b><ul>
<li>Implemented and tested recursive lambdas for shutdown (onQuit) and unit testing (onUnitTest), with correct type handling and null checks.</li>
</ul>
</li>
<li><b>Bug Fixes &amp; Stability:</b><ul>
<li>Diagnosed and resolved segmentation faults by adding null checks and debug output.</li>
<li>Tested resource handles and pointer management are more robust and safer, but further testing may be required.</li>
</ul>
</li>
<li><b>Testing &amp; Debugging:</b><ul>
<li>Added debug prints to trace resource creation and lifecycle events.</li>
<li>Validated that the system is ready for expanded DOM tree parsing and more complex resource hierarchies.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md347"></a>
[September 22, 2025]</h2>
<ul>
<li><b>Unit Test Framework Refined:</b> <br  />
<ul>
<li>Simplified the unit test system: now every resource implements <span class="tt">onUnitTests()</span> for built-in tests.</li>
<li>External/custom unit tests are registered and run via the <span class="tt">registerOnUnitTest()</span> callback, keeping the API minimal and flexible.</li>
<li>Removed unnecessary callback registration logic from <span class="tt">IUnitTest</span>, relying on virtual methods and user callbacks for extensibility.</li>
</ul>
</li>
<li><b>Consistent Naming:</b> <br  />
<ul>
<li>Standardized all unit test-related identifiers to use the plural form (<span class="tt">Tests</span>) for clarity and consistency across the codebase.</li>
</ul>
</li>
<li><b>External Test Integration:</b> <br  />
<ul>
<li>Users no longer need to register callbacks for external unit tests. <br  />
</li>
<li>Instead, external unit test functions (like <span class="tt">Core_UnitTests()</span> and <span class="tt">Factory_UnitTests()</span>) are simply called directly from within the already established <span class="tt">registerOnUnitTest()</span> callback in <span class="tt">main.cpp</span>. <br  />
</li>
<li>This approach makes it straightforward to create and run custom unit tests or build a dedicated test application, while maintaining clear separation between built-in and user-defined tests.</li>
</ul>
</li>
<li><b>API Cleanup:</b> <br  />
<ul>
<li>Removed redundant or overly complex code from the unit test infrastructure.</li>
<li>Ensured the API remains clean, maintainable, and easy to extend.</li>
</ul>
</li>
<li><b>Debugging &amp; Issue Resolution:</b> <br  />
<ul>
<li>Diagnosed and resolved issues with singleton access, reference binding, and infinite recursion in callback registration.</li>
<li>Improved understanding of C++ function pointer and lambda usage for flexible test registration.</li>
</ul>
</li>
<li><b>Expanded Test Coverage:</b> <br  />
<ul>
<li>Added more unit tests for Factory, Stage, and display objects.</li>
<li>Confirmed that the unit test system works well for new features.</li>
<li>Identified the need for a custom test object (e.g., <span class="tt">Box</span>) to facilitate comprehensive anchoring and coordinate propagation tests.</li>
<li>Planned to add live event tests (drag/drop, deferred add/remove) and prioritize tests for new features as they are developed.</li>
<li>Recognized that coverage for older features will be expanded over time, focusing first on the most critical areas.</li>
</ul>
</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md349"></a>
[September 23, 2025]</h3>
<ul>
<li><b>Event System Preliminary Testing:</b> <br  />
<ul>
<li>Successfully integrated and tested the event system with live SDL3 events.</li>
<li>Verified that mouse, keyboard, window, and focus events are received and dispatched correctly.</li>
<li>Confirmed that custom display objects (Box) receive and handle events as expected.</li>
<li>Minimal "life tests" for event propagation and Box object interaction are passing.</li>
<li>Debug output confirms event flow from SDL3 through Core, EventManager, and into display objects.</li>
<li>Refactored event dispatch logic for single-stage architecture, simplifying code and improving maintainability.</li>
<li>Cleaned up circular includes and pointer conversion issues, improving build stability.</li>
<li>Next steps: Expand event tests for Box (drag/drop, stacking, anchoring), add more interactive unit tests, and document event system usage.</li>
<li>Refactored codebase to use new <span class="tt">DisplayObject</span> and <span class="tt">ResHandle</span> types throughout.</li>
<li>Verified and debugged handle logic, ensuring safe pointer access and robust operator overloading.</li>
<li>Cleaned up event system: <span class="tt">EventManager</span> now fully leverages the handle system, removing unnecessary casts and improving safety.</li>
<li>Fixed segmentation faults and infinite recursion issues in tree traversal by clarifying handle usage and recursive logic.</li>
<li>Improved code readability and maintainability by removing legacy patterns and redundant checks.</li>
<li>All major event and display object interactions now use the new handle API.</li>
<li>Codebase is stable, with most reference and legacy issues resolved.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md351"></a>
[September 24, 2025]</h2>
<ul>
<li><b>Event System Debugging:</b><ul>
<li>Resolved compile-time issues with <span class="tt">ListenerEntry</span> constructor and <span class="tt">push_back</span> calls in <span class="tt">addEventListener</span>.</li>
<li>Verified that <span class="tt">addEventListener</span> correctly registers event listeners for both capture and bubbling phases.</li>
<li>Debugged and confirmed proper event propagation through the DOM hierarchy.</li>
<li>Fixed issues with <span class="tt">stopPropagation()</span> and <span class="tt">setPhase()</span> methods, ensuring they work as intended.</li>
<li>Verified that <span class="tt">stopPropagation()</span> halts event propagation during the target phase, skipping the bubbling phase.</li>
</ul>
</li>
<li><b>Box Object Testing:</b><ul>
<li>Tested <span class="tt">Box</span> object interactions with the event system:<ul>
<li>Verified correct output for capture, target, and bubbling phases.</li>
<li>Confirmed that <span class="tt">stopPropagation()</span> prevents bubbling as expected.</li>
</ul>
</li>
<li>Stacked <span class="tt">redBox</span> on <span class="tt">blueBox</span> and <span class="tt">greenBox</span> on <span class="tt">redBox</span> to test event propagation.</li>
<li>Validated event listener behavior for <span class="tt">MouseClick</span> events in all phases. The Box object is not perfect, but it works well enough for testing and serves as a proof of concept for an external application using the <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> API.</li>
</ul>
</li>
<li><b>Code Cleanup:</b><ul>
<li>Removed debug logs and redundant code from <span class="tt">addEventListener</span> and <span class="tt">triggerEventListeners</span>.</li>
<li>Simplified event listener registration and dispatch logic.</li>
</ul>
</li>
<li><b>Milestone:</b> Event System Stability<ul>
<li>After extensive debugging and testing, the <span class="tt">EventManager</span>, <span class="tt">EventListeners</span>, and overall event system are now stable and behave according to typical DOM specifications.</li>
<li>Both instant and deferred <span class="tt">addChild()</span> and <span class="tt">removeChild()</span> operations work reliably, ensuring robust event propagation and hierarchy management.</li>
<li>With the event system confirmed stable, we’ve decided this is the ideal time to begin transitioning from <span class="tt">JSON-based</span> initialization to <span class="tt">Sol2-powered Lua</span> scripting.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md353"></a>
[September 25, 2025]</h2>
<ul>
<li><b>JSON → Lua Transition Complete:</b> <br  />
<ul>
<li>All configuration, scripting, and resource creation now use Lua tables via Sol2.</li>
<li>Factory, Core, and EventManager refactored to accept and process <span class="tt">sol::table</span> configs.</li>
<li>All display object constructors updated to support Lua-based initialization.</li>
<li>Removed legacy JSON code paths and tests.</li>
</ul>
</li>
<li><b>Unit Tests Passing:</b> <br  />
<ul>
<li>All core, factory, display object, and stage unit tests now pass with Lua configs.</li>
<li>Verified resource creation, retrieval, type checking, and destruction using Lua.</li>
<li>Event system and Box object tests run successfully with Lua-driven scenes.</li>
</ul>
</li>
<li><b>Robust Numeric Handling:</b> <br  />
<ul>
<li>Fixed Sol2 numeric type issues by casting Lua numbers to C++ types as needed.</li>
<li>Optional properties (<span class="tt">x</span>, <span class="tt">y</span>, <span class="tt">width</span>, <span class="tt">height</span>) now default sensibly if missing.</li>
</ul>
</li>
<li><b>Improved Type Assignment:</b> <br  />
<ul>
<li>All display objects correctly assign and report their type from Lua configs.</li>
<li>Resource handles and type checks now work as expected.</li>
</ul>
</li>
<li><b>Documentation and API Consistency:</b> <br  />
<ul>
<li>Updated documentation to reflect Lua-first configuration and scripting.</li>
<li>All examples and tests now use Lua for initialization and setup.</li>
</ul>
</li>
<li><b>Milestone:</b> <br  />
<ul>
<li><a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> is now fully Lua-configurable and ready for advanced scripting, rapid prototyping, and integration with external tools. Json features have been removed completely.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md355"></a>
[September 26, 2025]</h2>
<ul>
<li><b>Box Unit Tests Complete:</b> <br  />
<ul>
<li>Finalized comprehensive unit tests for the Box object, covering creation, hierarchy, anchor logic, and world coordinate propagation.</li>
<li>All anchor setters and edge references are tested for all anchor points and hierarchy levels.</li>
<li>Confirmed that the Box object works as a reliable proof of concept for external applications using the <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> API.</li>
<li>Decided to defer exhaustive reference calculation tests for resizing and complex anchor scenarios until a specific layout issue is identified.</li>
<li>The Box unit test suite is now robust and maintainable; targeted tests will be added as new bugs or features arise.</li>
</ul>
</li>
<li><b>Orphaned Display Object Management:</b> <br  />
<ul>
<li>Implemented <span class="tt">Factory::countOrphanedDisplayObjects()</span>, <span class="tt">getOrphanedDisplayObjects()</span>, and <span class="tt">destroyOrphanedDisplayObjects()</span> for robust orphan detection and cleanup.</li>
<li>Improved <span class="tt">destroyOrphanedDisplayObjects()</span> to recursively remove all orphaned objects, including nested orphans, ensuring a clean DOM state after parent removal.</li>
<li>Added unit tests to verify orphan detection and recursive cleanup logic.</li>
<li>Documented the current behavior and discussed future enhancements for selective orphan preservation.</li>
<li>Proposed an <span class="tt">OrphanCleanupPolicy</span> enum for <span class="tt">IDisplayObject</span> to allow marking objects as persistent, templates, or editor-only, enabling fine-grained control over orphan cleanup (feature deferred for future implementation).</li>
</ul>
</li>
<li><b>General Stability:</b> <br  />
<ul>
<li>All core, factory, display object, and stage unit tests are passing.</li>
<li>Event system and Lua-driven configuration are stable and fully integrated.</li>
<li>Documentation and codebase are up-to-date with recent changes.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md357"></a>
[September 27, 2025]</h2>
<ul>
<li><b>Lua Integration Complete:</b> <br  />
<ul>
<li>All major Core and Factory methods are now exposed to Lua via Sol2 usertype registration.</li>
<li>Overloaded methods and custom types (DisplayObject, SDL_Color) are correctly bound and accessible from Lua scripts.</li>
<li>The Lua API is stable, with all required commands available for scripting, configuration, and test automation.</li>
</ul>
</li>
<li><b>Lua/C++ Unit Test Integration Enhanced:</b> <br  />
<ul>
<li>Refined Lua-driven unit tests for display object creation, stage hierarchy, and destruction.</li>
<li>Confirmed that DisplayObjects automatically become invalid (<span class="tt">nullptr</span>) when their resource is destroyed in the Factory, ensuring safe reference semantics.</li>
<li>Improved <span class="tt">IDisplayObject::hasChild()</span> logic to check both handle presence and validity, preventing false positives when objects are deleted.</li>
<li>All current unit tests now pass, including tests for creation, addition to stage, and destruction/removal verification.</li>
<li>Added Lua-side debugging utilities: Factory registry and stage tree can be printed directly from Lua scripts for live inspection.</li>
<li>Demonstrated robust C++/Lua test integration: Lua scripts return boolean results to C++ test framework, enabling seamless cross-language validation.</li>
<li>Codebase and Lua API stability increased, with reliable resource management and hierarchy checks.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md359"></a>
[September 28, 2025]</h2>
<ul>
<li><b>Lua Binding Improvements:</b><ul>
<li>Refined Lua usertype registration to ensure idempotent and consistent bindings.</li>
<li>Verified that all properties, commands, and functions are correctly exposed to Lua for Core, Factory, DisplayObject, and IDisplayObject.</li>
<li>Added missing getters (<span class="tt">getX</span>, <span class="tt">getY</span>, <span class="tt">getWidth</span>, <span class="tt">getHeight</span>) to DisplayObject Lua bindings.</li>
<li>Ensured that overloaded methods are properly handled in Lua.</li>
<li>Centralized Lua bindings: Factory now maintains a registry (<span class="tt">registerLuaProperty</span> / <span class="tt">registerLuaCommand</span> / <span class="tt">registerLuaFunction</span>) and applies entries idempotently in a two‑phase process (create minimal sol2 usertype, then attach registry entries).</li>
<li>Lua API &amp; binding fixes: <span class="tt">DisplayObject</span> and <span class="tt">Core</span> bindings improved (correct boxing/forwarding, colon-call signatures); EventType constants exposed; Sol2 runtime issues (nil-call/userdata mismatches) resolved.</li>
<li>Test helpers: added <span class="tt">Core:pushMouseEvent({x,y,type,button})</span> and <span class="tt">Core:pumpEventsOnce()</span> so Lua can synthesize and dispatch SDL events deterministically.</li>
<li>DisplayObject Lua conveniences: <span class="tt">addEventListener</span> forwarding and simple getters (<span class="tt">getX</span>/<span class="tt">getY</span>/<span class="tt">getWidth</span>/<span class="tt">getHeight</span>) exposed to Lua.</li>
<li>Box test scaffolding: added simple Box functions (doSomething, resetColor) and a click counter used by synthetic-event tests.</li>
<li>Lua-driven tests added/updated:<ul>
<li>test5: getPropertyNamesForType("blueishBox")</li>
<li>test6: getFunctionNamesForType("blueishBox")</li>
<li>test7: getCommandNamesForType("blueishBox")</li>
<li>test8: C++-synthesized MouseClick → Box listener</li>
<li>test9: Lua-only listener + synthetic click (restores keyboard focus to Stage)</li>
</ul>
</li>
<li>Cleanup: removed temporary debug instrumentation and test-only Factory helpers.</li>
<li>Status: All core C++ unit tests and Lua-driven tests pass locally.</li>
</ul>
</li>
<li><b>Event System Enhancements:</b><ul>
<li>Improved synthetic event handling in Lua with <span class="tt">Core:pushMouseEvent()</span> and <span class="tt">Core:pumpEventsOnce()</span>.</li>
<li>Verified that synthetic events correctly trigger event listeners on display objects.</li>
</ul>
</li>
<li><b>Box Object Enhancements:</b><ul>
<li>Added utility functions to Box for testing purposes (e.g., <span class="tt">doSomething</span>, <span class="tt">resetColor</span>).</li>
<li>Implemented a click counter to track interactions during tests.</li>
</ul>
</li>
<li><b>Unit Test Expansion:</b> <br  />
<ul>
<li>Added new Lua-driven unit tests to cover property, command, and function retrieval for custom display objects.</li>
<li>Verified that all existing tests pass successfully with the latest Lua bindings.</li>
</ul>
</li>
<li><b>Code Cleanup:</b><ul>
<li>Removed temporary debug instrumentation and test-only Factory helpers.</li>
<li>Ensured the codebase is clean and maintainable.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md361"></a>
[September 29, 2025]</h2>
<ul>
<li><b>Lua Binding Debugging:</b><ul>
<li>Added controlled debug prints to Lua usertype registration to trace binding operations.</li>
<li>Verified that each usertype (DisplayObject, IDisplayObject, Stage, Factory, Core) is registered exactly once, preventing conflicts and ensuring consistent behavior.</li>
<li>Debug prints can be toggled with the <span class="tt"><a class="el" href="SDOM_8hpp.html#a7860bad07e6389722d5d09638b46d2f8">DEBUG_REGISTER_LUA</a></span> constant in <span class="tt"><a class="el" href="SDOM_8hpp.html">SDOM.hpp</a></span>.</li>
</ul>
</li>
<li><b>Binding Consistency:</b><ul>
<li>Ensured that all Lua bindings are idempotent and do not conflict with each other.</li>
<li>Verified that overloaded methods and custom types are correctly handled in Lua.</li>
</ul>
</li>
<li><b>Code Cleanup:</b><ul>
<li>Removed unnecessary debug prints from production code, leaving controlled logging for future debugging needs.</li>
<li>Ensured the codebase remains clean and maintainable.</li>
</ul>
</li>
<li><b>Core Lua Wrappers Verified:</b><ul>
<li>Completed verification of Core/Factory Lua wrapper coverage (get/set window title, event helpers, DisplayObject forwards, focus/hover helpers, object lookup, and orphan management commands exposed to Lua).</li>
<li>Added <span class="tt">test20_lua</span> which validates <span class="tt">Core:getWindowTitle()</span> and <span class="tt">Core:setWindowTitle()</span> round-trip behavior; the <span class="tt">examples/test/prog</span> test binary builds and runs with the new test.</li>
<li>As requested, the <span class="tt">clearFactory</span> Lua binding was removed (it can be reintroduced later if needed).</li>
</ul>
</li>
<li><b>Lua Bounds / DisplayObject updates (today):</b><ul>
<li>Exposed a typed <span class="tt">Bounds</span> userdata to Lua (fields: <span class="tt">left/top/right/bottom</span>, integer/float helpers) and added method-style getters (<span class="tt">getLeft</span>/<span class="tt">getTop</span>/<span class="tt">getRight</span>/<span class="tt">getBottom</span>/<span class="tt">getX</span>/<span class="tt">getY</span>/<span class="tt">getWidth</span>/<span class="tt">getHeight</span>) plus an epsilon-aware helper <span class="tt">almostEqual(a,b,eps?)</span> for robust comparisons.</li>
<li>Synchronized <span class="tt">Bounds</span> registrations so both <span class="tt">DisplayObject</span> and <span class="tt">IDisplayObject</span> present a consistent Lua API.</li>
<li>Added/updated DisplayObject forwards so Lua can call <span class="tt">h:getBounds()</span> (returns <span class="tt">Bounds</span> userdata) and <span class="tt">h:setBounds({...})</span> (accepts a Lua table), and added edge getters (<span class="tt">getLeft</span>/<span class="tt">getTop</span>/<span class="tt">getRight</span>/<span class="tt">getBottom</span>) on the handle.</li>
<li>Reworked the IDisplayObject unit tests: made <span class="tt">test10</span> a Lua-only bounds comparison and added <span class="tt">test11</span> to drive <span class="tt">setBounds</span> from Lua and verify <span class="tt">getX</span>/<span class="tt">getY</span>/<span class="tt">getWidth</span>/<span class="tt">getHeight</span> and edge getters.</li>
<li>Verified the change by building (<span class="tt">./compile</span>) and running the test binary (<span class="tt">./prog</span>); all unit tests passed locally.</li>
</ul>
</li>
<li><b>Lua wrapper headers verified:</b><ul>
<li>Both primary bulk Lua wrapper headers, <span class="tt">lua_Core.hpp</span> and <span class="tt">lua_IDisplayObject.hpp</span>, have complete implementations and are exercised by the <span class="tt">examples/test</span> Lua unit tests. The test run (<span class="tt">./compile clean &amp;&amp; ./prog</span>) confirms Lua-level coverage for creation, property access, event helpers, DisplayObject forwards, anchors/edges, geometry, and factory helpers.</li>
<li>Temporary debug prints used during binding debugging were cleaned up; controlled registration logging remains toggleable via <span class="tt"><a class="el" href="SDOM_8hpp.html#a7860bad07e6389722d5d09638b46d2f8">DEBUG_REGISTER_LUA</a></span> in <span class="tt"><a class="el" href="SDOM_8hpp.html">SDOM.hpp</a></span>.</li>
</ul>
</li>
<li><b>DisplayObject_UnitTests:</b> DisplayObject_UnitTests now contains:<ul>
<li>A concise numeric mapping header above the DisplayObject tests.</li>
<li>Full human-readable descriptions (matching the strings passed to UnitTests::run) in place of the short mapping comments.</li>
<li>Test functions renamed to DisplayObject_test1 … DisplayObject_test10.</li>
<li>The tests vector updated to call the new functions and includes matching descriptive comments.</li>
<li>Debug output updated to reference DisplayObject_test10 where applicable.</li>
<li>A clean build and test run were executed successfully. <br  />
</li>
<li>Reworked the DisplayObject unit tests for readability and maintainability: added a numeric mapping header, expanded inline descriptions to match <span class="tt">UnitTests::run</span> strings, and renamed test functions to <span class="tt">DisplayObject_test1</span>..<span class="tt">DisplayObject_test10</span>. <br  />
</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md363"></a>
[September 30, 2025]</h2>
<ul>
<li><b>Summary:</b><ul>
<li>Consolidated work focused on lifecycle event dispatch, Lua bindings robustness, and logging/debug cleanup. These changes make lifecycle events available to Lua listeners, surface Lua errors, and stabilize the debug/logging surface for continued iteration.</li>
</ul>
</li>
<li><b>Event dispatch &amp; lifecycle hooks:</b><ul>
<li>Factory now emits EventType::OnInit immediately after object initialization (useful for global/stage listeners).</li>
<li>Core dispatches EventType::OnQuit globally during shutdown via EventManager::dispatchEvent().</li>
<li>Core::run() now dispatches stage-level listener events:<ul>
<li>EventType::OnEvent — after queued SDL event dispatch</li>
<li>EventType::OnUpdate — immediately before onUpdate traversal</li>
<li>EventType::OnRender — immediately after onRender, before present</li>
</ul>
</li>
<li>For Update/Render/Event hooks we dispatch to event-listeners only (dispatchEventToAllEventListenersOnStage) to avoid duplicating node-&gt;onEvent() behavior.</li>
<li>Note: these dispatch points are listeners hooks; they do not replace per-node onUpdate()/onRender() unless an API is added to allow listeners to disable default behavior.</li>
</ul>
</li>
<li><b>Lua: Event / EventType bindings &amp; robustness:</b><ul>
<li>Centralized EventType → Lua exposure using the EventType registry to avoid string mismatches.</li>
<li>Added a Lua usertype for Event exposing: dt (elapsed), type/typeName, target (DisplayObject) and convenience accessors name / getName() (prefers target name, falls back to event type).</li>
<li>Made lua listener registration use table form { type = EventType.X, listener = fn } in examples.</li>
<li>Replaced inline lambdas in examples with named callbacks in examples/test/lua/callbacks/listener_callbacks.lua.</li>
<li>Wrapped all Lua callback invocations with sol::protected_function to log Lua errors (no silent failures).</li>
<li>Fixed multiple example Lua issues (missing 'end' in render.lua, undefined EMA vars) so OnUpdate/OnEvent/OnRender prints now appear as expected.</li>
</ul>
</li>
<li><b>Event Types &amp; Listener Semantics:</b><ul>
<li>New lifecycle/event hooks added for fine‑grained listener control:</li>
<li>OnPreRender — listener‑only, per‑node. Fired immediately after a node renders itself and before its children are rendered (useful for backgrounds or setup that should appear under children).</li>
<li>OnRender — listener‑only, per‑node. Fired after a node and all its children have been rendered and before present (useful for overlays, HUDs, screenshots).</li>
<li>OnUpdate — per‑node. Listeners run first for the node, then the node's default onUpdate runs (listeners may call disableDefaultBehavior() to prevent the default).</li>
<li>OnEvent — input/event dispatch using capture → target → bubble phases; listeners run before the default onEvent at the target and may stopPropagation()/disableDefaultBehavior().</li>
<li>OnInit / OnQuit — lifecycle hooks: OnInit is emitted after object creation/initialization, OnQuit is dispatched globally during shutdown.</li>
</ul>
</li>
<li><b>Semantics and best practices:</b><ul>
<li>Listener‑only hooks (OnPreRender/OnRender) are dispatched using the event‑listener path so they do not duplicate node-&gt;onEvent() behavior.</li>
<li>Listeners receive the same mutable Event instance, so calling stopPropagation() or disableDefaultBehavior() affects subsequent dispatch and default handlers.</li>
<li>Per‑node events are targeted at the node's DisplayObject so node‑attached listeners see a meaningful currentTarget.</li>
<li>Lua examples use the table form <span class="tt">{ type = EventType.X, listener = fn }</span> and can rely on <span class="tt">evt.name</span> / <span class="tt">evt:getName()</span> to get a sensible name (target name or type).</li>
</ul>
</li>
<li><b>Performance notes:</b><ul>
<li>Hot paths check for listeners before constructing per‑frame Event objects (hasListeners fast‑path) to avoid unnecessary allocations when no listeners are registered.</li>
<li>Cache Lua wrapper objects at registration time (sol::protected_function) to avoid per‑dispatch wrapper construction in high‑frequency events such as OnUpdate and mouse motion.</li>
</ul>
</li>
<li><b>Debugging &amp; logging:</b><ul>
<li>Replaced ad-hoc std::cout debug prints with DEBUG_LOG macro and made macro stream-friendly to fix compile-time operator&lt;&lt; usage.</li>
<li>Removed or gated noisy temporary debug prints (e.g., pushMouseEvent_lua) and made them controllable so normal runs are not spammy.</li>
<li>Left a clear, short comment about EventType::registerAll() retained as a static-init-order safety hedge (user EventTypes still register themselves in their constructors).</li>
</ul>
</li>
<li><b>Build &amp; verification:</b><ul>
<li>Fixed compile regressions introduced during iteration; rebuilt examples/test successfully.</li>
<li>Ran examples/test/prog: unit tests pass; observed expected runtime output for OnInit/OnUpdate/OnRender/OnEvent/OnQuit Lua handlers.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md365"></a>
[October 2, 2025]</h2>
<ul>
<li><b>Synthetic Event Handling Robustness:</b><ul>
<li>Refined synthetic mouse event generation and dispatch to work reliably in both floating and tiled window manager modes.</li>
<li>Ensured all synthetic events use <span class="tt">SDL_RenderCoordinatesToWindow()</span> for correct mapping from logical to window coordinates, fixing previous issues with negative or out-of-bounds coordinates.</li>
<li>Updated Lua and C++ event helpers to guarantee robust event delivery and handler invocation.</li>
<li>Verified that all mouse-related unit tests (including Lua-driven synthetic click and hover tests) now pass in both environments.</li>
<li>Improved event queue draining in <span class="tt">Core::pumpEventsOnce()</span> to ensure all queued events are dispatched before returning, eliminating timing issues in Lua event handler tests.</li>
<li>Added diagnostic logging to synthetic event helpers and event handlers for easier debugging and verification of coordinate mapping and event flow.</li>
</ul>
</li>
<li><b>Unit Test Reliability:</b><ul>
<li>Addressed timing issues in Lua unit tests by polling for event handler completion, ensuring tests do not return before handlers are invoked.</li>
<li>Confirmed that both Lua and C++ unit tests pass consistently across different compositors and window manager modes.</li>
<li>Documented best practices for synthetic event testing and event queue management.</li>
</ul>
</li>
<li><b>Documentation &amp; Debugging:</b><ul>
<li>Updated documentation to reflect recent changes in event dispatch, Lua bindings, and synthetic event handling.</li>
<li>Added notes and troubleshooting tips for running tests under different window managers (floating vs. tiled).</li>
<li>Improved error reporting and debug output for configuration loading and Lua script execution.[October 1, 2025]**</li>
<li>Lua/Event binding &amp; SDL event exposure (today):<ul>
<li>Expanded <span class="tt">SDL_Utils::eventToLuaTable()</span> to expose many SDL3 event fields to Lua (mouse, keyboard, gamepad, pen, touch, camera, audio, sensor, render, user, etc.).</li>
<li>Centralized <span class="tt">Event</span> Lua usertype creation in <span class="tt"><a class="el" href="classSDOM_1_1Event.html#a4f6b28e5635e88595288a6c66de4a74a">SDOM::Event::registerLua()</a></span> and added bindings for the full set of Event accessors and mutators so Lua can call methods like <span class="tt">evt:getMouseX()</span> and use properties <span class="tt">evt.mouseX</span>.</li>
<li>Added <span class="tt">Event::getName()</span> (C++ implementation) and switched the Lua <span class="tt">name</span> property to use the member-pointer binding (single source of truth + proper locking).</li>
<li>Implemented safe <span class="tt">getPayload</span>/<span class="tt">setPayload</span> Lua bindings (payload returned as a Lua table via the current Lua state to avoid lifetime issues).</li>
<li>Exposed lower-camelcase convenience properties (e.g., <span class="tt">mouse_x</span>, <span class="tt">mouse_y</span>, <span class="tt">wheel_x</span>, <span class="tt">click_count</span>, <span class="tt">click_count</span>, <span class="tt">ascii_code</span>, etc) as <span class="tt">sol::property</span> pairs for readable/writable access from Lua.</li>
<li>Verified the project builds cleanly after these changes (<span class="tt">./compile</span> run in <span class="tt">examples/test</span> succeeded and unit tests built/run as part of the test binary).</li>
</ul>
</li>
<li>Notes:<ul>
<li>Where getters return Lua-managed objects (like <span class="tt">sol::table</span> payloads) we kept lambda bindings so we can safely create <span class="tt">sol::object</span> tied to the current <span class="tt">sol::state</span>.</li>
<li><span class="tt">SDL_Utils</span> still exposes <span class="tt">eventToLuaTable</span> as a Lua helper table (<span class="tt">SDL</span>/<span class="tt">SDL_Utils</span>) for direct use; <span class="tt">Event::registerLua()</span> uses the C++ helper internally for the <span class="tt">sdl</span> property.</li>
<li>Example update: <span class="tt">examples/test/lua/callbacks/listener_callbacks.lua</span> was adjusted to colorize the "target:" label using the DisplayObject <span class="tt">getColor()</span> Lua binding and <span class="tt">CLR.fg_rgb(r,g,b)</span>; the code uses <span class="tt">pcall</span> fallbacks so it degrades gracefully when color or handle info is unavailable.</li>
<li>Verified: rebuilt the examples and test binary after these changes (<span class="tt">./compile</span> in <span class="tt">examples/test</span>) — build completed and <span class="tt">prog</span> produced successfully.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md367"></a>
[October 3, 2025]</h2>
<ul>
<li>Cleaned up noisy debug output across the codebase:<ul>
<li>Replaced ad-hoc std::cout dbg prints with DEBUG_LOG and gated test‑only logs behind a new DEBUG_LUA_TESTS / LUA_INFO wrapper.</li>
<li>Converted recent <a class="el" href="SDOM_8hpp.html#aedf01192151e10a6620567952711ff69" title="Logs an informational message to stdout.">INFO()</a> diagnostics used for Lua testing to LUA_INFO so they are off by default.</li>
</ul>
</li>
<li>Stabilized and hardened Lua bindings and factory behavior:<ul>
<li>Exposed Bounds as a proper sol2 usertype so Lua can read/write edges and call width()/height().</li>
<li>Ensured SDL_Color and other helper types are Lua‑friendly.</li>
<li>Enforced unique display object names in Factory (creation now throws on duplicates); updated unit tests to catch the exception.</li>
</ul>
</li>
<li>Fixed event / synthetic event issues and test timing:<ul>
<li>Pump loop improved to drain the event queue completely before returning, removing timing races in Lua tests.</li>
<li>Synthetic mouse events now use SDL_RenderCoordinatesToWindow and hit‑testing was verified; added targeted instrumentation to confirm coordinate mapping and top‑hit selection.</li>
<li>Mouse hover unit test (Lua #19) diagnostic instrumentation added and the failing hover test was fixed.</li>
</ul>
</li>
<li>Display object / hierarchy fixes:<ul>
<li>Prevented duplicate children by name during attachment and added dedupe in sortChildrenByPriority (keeps most‑recent entry).</li>
<li>Improved setParent bookkeeping (remove old entries, preserve world bounds, add to new parent), and reduced duplicate insertion regressions.</li>
<li>Added Lua overloads for priority/z‑order helpers (accept numeric and table descriptor forms) to match test call shapes.</li>
</ul>
</li>
<li>Identifier updates (bindings &amp; Lua surface):<ul>
<li>Performed a sweep of function identifier changes to simplify the Lua/C++ surface and improve consistency:<ul>
<li>Renamed (old → new):<ul>
<li>getDisplayObjectHandle → getDisplayObject</li>
<li>getStageHandle_lua → getStage_lua</li>
<li>getRootNode_lua → getRoot_lua</li>
<li>setRootNodeByHandle_lua → setRootNode_lua</li>
<li>setStage_lua → setStageByName_lua</li>
<li>handleTabKeyPress_lua → doTabKeyPressForward_lua</li>
<li>handleTabKeyPressReverse_lua → doTabKeyPressReverse_lua</li>
</ul>
</li>
<li>Added:<ul>
<li>setStage_lua(const DisplayObject&amp; handle) — set stage by handle (Lua helper)</li>
<li>setRootNode_lua(const DisplayObject&amp; handle) — helper for root node by handle</li>
<li>permissive Lua overloads for addEventListener / removeEventListener (table descriptor + typed args)</li>
</ul>
</li>
<li>Removed / consolidated:<ul>
<li>Legacy getDisplayObjectHandle Lua mapping (removed in favor of getDisplayObject)</li>
<li>getRootNodePtr_lua and other raw-pointer helpers (no raw pointer exposure to Lua)</li>
</ul>
</li>
</ul>
</li>
<li>Compatibility &amp; notes:<ul>
<li>Where practical, compatibility shims were left or added briefly (inline forwards) to prevent immediate breakage; these can be removed once downstream scripts are updated.</li>
<li>Global <span class="tt">Core</span> is now consistently exposed as a forwarding table (CoreForward) for predictable colon/dot call semantics; Core userdata remains registered but is not the global to avoid dispatch ambiguity.</li>
</ul>
</li>
</ul>
</li>
<li>Build &amp; CI fixes:<ul>
<li>Restored minimal Factory/Core forwarding stubs for deprecated introspection APIs to resolve linker errors during refactors.</li>
<li>Rebuilt and validated examples/test/prog — full unit test suite passes on local runs after fixes.</li>
</ul>
</li>
<li>Developer ergonomics:<ul>
<li>Added DEBUG_LUA_TESTS macro and CMake toggle guidance so Lua test diagnostics can be enabled without editing source.</li>
<li>Left controlled registration logging (DEBUG_REGISTER_LUA) for binding diagnostics.</li>
</ul>
</li>
<li>Status: ~90% working — core orphan detection and policy handling are implemented and exercised by the unit tests, but a couple of issues remain under investigation.</li>
<li>Implemented:<ul>
<li>OrphanRetentionPolicy on IDisplayObject (Manual / AutoDestroy / GracePeriod).</li>
<li>Factory orphan queue, getOrphanedDisplayObjects(), and a collectGarbage() pass that respects policies:<ul>
<li>AutoDestroy → eligible for immediate destruction (when safe).</li>
<li>GracePeriod → retained until grace timeout; reparenting during the window cancels destruction.</li>
<li>RetainUntilManual → never auto-destroyed.</li>
</ul>
</li>
<li>Lua bindings and string helpers to set/get orphan policies from scripts.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md369"></a>
[October 4, 2025]</h2>
<ul>
<li>Quick fixes &amp; Lua binding polish (morning)<ul>
<li>Fixed a typo in examples/test Lua callback (evt.taget → evt.target) that caused nil-index errors in right‑click handlers.</li>
<li>Added a safe convenience: <span class="tt">IDisplayObject::removeFromParent()</span> and Lua bindings so scripts can call <span class="tt">evt.target:removeFromParent()</span> directly from listeners.</li>
<li>Implemented recursive removal helpers: <span class="tt">removeDescendant(...)</span> (depth‑first, first match) and exposed them to Lua on both <span class="tt">IDisplayObject</span> and <span class="tt">DisplayObject</span> handle usertypes.</li>
<li>Added <span class="tt">removeChild(const std::string&amp;)</span> overload and corresponding Lua binding so <span class="tt">parent:removeChild("name")</span> works without userdata coercion; fixed overload registration to avoid Lua/C++ type mismatch.</li>
<li>Removed confusing const predicate overloads that were misnamed (they behaved like hasChild checks); cleaned up their Lua wrappers to avoid ambiguity.</li>
<li>Added a small compatibility helper <span class="tt">getStage()</span> in Lua bindings to avoid breaking existing example scripts.</li>
<li>Fixed binding registration issues (explicit function-pointer casts / sol::overload) so the new helpers expose unambiguous APIs to Lua.</li>
<li>Rebuilt and ran the examples/test suite — compilation succeeded and unit tests passed locally after the changes.</li>
</ul>
</li>
<li>Next actions<ul>
<li>Add unit tests that specifically exercise <span class="tt">removeFromParent()</span>, <span class="tt">removeDescendant()</span> (handle/name), and <span class="tt">removeChild(name)</span> semantics (edge cases, nested removals, event-time removals).</li>
<li>Consider removing temporary compatibility shims (getStage global, any legacy forwards) once examples are migrated to canonical Core/Factory bindings.</li>
<li>Improve docs/comments in headers to clarify difference between strict <span class="tt">removeChild</span> (direct child) vs. recursive removal and the convenience <span class="tt">removeFromParent()</span> behavior. <br  />
</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md371"></a>
[October 5, 2025]</h2>
<ul>
<li>Refactored Lua Core bindings:<ul>
<li>Centralized and simplified Core::<em>registerDisplayObject() by introducing small per-signature binder lambdas (<span class="tt">bind_noarg</span>, <span class="tt">bind_table</span>, <span class="tt">bind_string</span>, <span class="tt">bind_bool_arg</span>, <span class="tt">bind_do_arg</span>, `bind_return</em>*<span class="tt"> and </span>bind_callback_*<span class="tt">).</span></li>
<li><span class="tt">All Core APIs are now registered consistently in three places: usertype methods (colon-call), CoreForward table entries, and optional global aliases — reducing duplication and eliminating subtle behavioral mismatches.</span></li>
<li><span class="tt">Consolidated all registerOn* callback wrappers with per-signature factories so Lua-&gt;C++ callback wiring and error handling is uniform.</span></li>
<li><span class="tt">Added permissive handlers for mixed-argument helpers (e.g., setRootNode / setStage accept string, handle, or name-table), and convenient aliases (setRoot -&gt; setRootNode).</span></li>
<li><span class="tt">Improved maintainability: adding new Core functions or aliases requires a single-line registration using the appropriate binder.</span></li>
<li><span class="tt">Build and unit tests pass locally after the changes.</span></li>
</ul>
</li>
<li><span class="tt">Notes / next steps:<ul>
<li>Plan to move the binder lambdas into a dedicated implementation (e.g., src/lua_Core_bindings.cpp) and expose small static helpers so other modules (IDisplayObject, Event, EventType, SDL) can reuse the same registration patterns. Postpone that move until Lua smoke tests and CI are stable.</li>
</ul>
</span></li>
<li><span class="tt">Additional Oct 5 updates (implementation details):<ul>
<li>Added a reusable header and implementation for the bind helpers: </li>
</ul>
</span>include/SDOM/lua_BindHelpers.hpp<span class="tt"> and </span>src/lua_BindHelpers.cpp<span class="tt">. These centralize the per-signature helper implementations previously expressed as local lambdas.<ul>
<li>Rewired several Core bindings in </li>
</ul>
</span><a class="el" href="SDOM__Core_8cpp.html">src/SDOM_Core.cpp</a><span class="tt"> to use the new helpers (examples: </span>quit<span class="tt">, </span>registerOn<span class="tt">, </span>setStage<span class="tt">, </span>setRootNode<span class="tt">, </span>setRoot<span class="tt">). More inline lambdas remain and will be swept in a follow-up.<ul>
<li>Replaced a previously-silent catch around </li>
</ul>
</span>EventType<span class="tt"> registration with visible debug logging (</span><a class="el" href="SDOM_8hpp.html#a21a2c7330a04ac78200a986f66609369" title="Logs a debug message in green text.">DEBUG_LOG(...)</a><span class="tt">) and added a short explanatory comment about lifetime/static-init-order assumptions.<ul>
<li>Verified the change locally: ran the project's compile/test flow (</li>
</ul>
</span>./compile<span class="tt"> in </span>examples/test<span class="tt">), the library and test binary built and installed headers under </span>~/.local/include/SDOM<span class="tt"> and </span>~/.local/lib/libSDOM.a<span class="tt"> updated.<ul>
<li>Next short steps: complete a full sweep of remaining inline binding lambdas in </li>
</ul>
</span><a class="el" href="SDOM__Core_8cpp.html">SDOM_Core.cpp</a><span class="tt">, add a small Lua smoke test exercising name-or-handle binds, and then consider moving the helpers into a dedicated </span>lua_Core_bindings.cpp` once CI is stable.</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md373"></a>
[October 6, 2025]</h2>
<ul>
<li>Lua binding refactor (IDisplayObject):<ul>
<li>Replaced repetitive sol2 wrappers with small, signature-based helper lambdas using a consistent naming scheme: <span class="tt">bind_{return}_{args}</span> (e.g., <span class="tt">bind_R_0</span>, <span class="tt">bind_void_i</span>, <span class="tt">bind_R_do</span>, <span class="tt">bind_void_str</span>, <span class="tt">_nc</span> variants for non-const).</li>
<li>Applied helpers across hierarchy, priority/z-order, focus/interactivity, tab management, geometry/layout, anchors, edge positions, and orphan retention bindings.</li>
<li>Kept <span class="tt">sol::overload</span> only where flexible call shapes are needed (e.g., <span class="tt">setPriority</span>, <span class="tt">setZOrder</span>, <span class="tt">moveToTop</span>, <span class="tt">setToHighest/LowestPriority</span>).</li>
</ul>
</li>
<li>Lua wrappers (lua_IDisplayObject.cpp):<ul>
<li>Added flexible wrappers that accept descriptor tables and handle-or-name targets:<ul>
<li><span class="tt">setPriority_lua_any</span>, <span class="tt">setPriority_lua_target</span>, <span class="tt">setZOrder_lua_any</span>, <span class="tt">moveToTop_lua_any</span>, <span class="tt">setToHighestPriority_lua_any</span>, <span class="tt">setToLowestPriority_lua_any</span>.</li>
</ul>
</li>
<li>Added a handle-aware <span class="tt">getName_handle_lua</span> and updated <span class="tt">getName</span> binding to prefer the live object and fall back to handle name to fix a unit test edge case.</li>
<li>Aligned orphan retention helpers (<span class="tt">orphanPolicyFromString</span>, <span class="tt">orphanPolicyToString</span>, <span class="tt">setOrphanRetentionPolicy</span>, <span class="tt">getOrphanRetentionPolicyString</span>) to helper binders, including an enum binder (<span class="tt">bind_R_orp</span>).</li>
</ul>
</li>
<li>Debug/log cleanup:<ul>
<li>Removed remaining temporary diagnostics (<span class="tt">[DIAG] ...</span>, <span class="tt">[debug-registerOnLua] ...</span>) from Lua bindings; normal output is now clean by default.</li>
</ul>
</li>
<li>Tests:<ul>
<li>Rebuilt examples/test; unit tests pass after the binding/wrapper updates.</li>
</ul>
</li>
<li>Maintainability:<ul>
<li>Binding surface is now uniform and easier to extend; helper pattern reduces boilerplate and mismatches between similar APIs.</li>
<li>Next: consider moving common bind helpers into the shared <span class="tt">lua_BindHelpers</span> so other modules can reuse them, and add brief docs for descriptor-table forms (priority/z-order/moveToTop) in the Lua scripting guide.</li>
</ul>
</li>
<li>Orphan / garbage-collection work<ul>
<li>Exposed orphan-grace accessors to Lua: getOrphanGrace / setOrphanGrace (milliseconds).</li>
<li>Implemented Lua-side GC test (GarbageCollection_test4):<ul>
<li>Test temporarily lowers an object's orphan grace to 500ms, removes it, polls Core:collectGarbage(), and verifies the orphan is destroyed within ORPHAN_GRACE_PERIOD + 500ms.</li>
<li>Test restored the original grace period on completion.</li>
</ul>
</li>
<li>Tests updated to time out based on the C++ ORPHAN_GRACE_PERIOD constant for deterministic behavior.</li>
</ul>
</li>
<li>Orphan retention / garbage collection implemented:<ul>
<li>Added OrphanRetentionPolicy on IDisplayObject (AutoDestroy, GracePeriod, RetainUntilManual).</li>
<li>Added orphanGrace (ms) and get/set accessors; exposed to Lua (<span class="tt">getOrphanGrace</span> / <span class="tt">setOrphanGrace</span>).</li>
<li>Factory now tracks orphanedAt and respects policies in collectGarbage().</li>
<li>Added Lua bindings and unit tests (GarbageCollection_test2..test4) verifying auto-destroy, grace-period behavior, and manual retention.</li>
<li>Tests use ORPHAN_GRACE_PERIOD for deterministic timeouts; SDL.Delay bound for Lua tests.</li>
</ul>
</li>
<li>SDL / test utilities<ul>
<li>Bound SDL.Delay to Lua (supports both SDL.Delay(ms) and SDL:Delay(ms) method-call forms) to allow deterministic sleeps from Lua tests.</li>
<li>Added small-step wait loop in tests that repeatedly calls Core:collectGarbage() + SDL:Delay() for responsive detection.</li>
</ul>
</li>
<li>Completed and consolidated Lua‑driven unit tests for DisplayObject / IDisplayObject:<ul>
<li>Added/validated tests covering dirty/state management, hierarchy (getChild/getParent), focus &amp; interactivity, geometry &amp; layout, priority/z‑order, anchors/edges, and bounds/color handling (tests #11–#15).</li>
<li>Anchor tests exercise all 9 AnchorPoint values on each edge and assert that X/Y/Width/Height remain unchanged after each anchor change.</li>
</ul>
</li>
<li>Lua binding fixes and coverage:<ul>
<li>Added missing Lua binding for getChild on DisplayObject handles.</li>
<li>Fixed logic bug in isClickable test and improved raw‑string safety for embedded Lua chunks.</li>
<li>Annotated include/SDOM/lua_IDisplayObject.hpp to reflect which wrappers are exercised by unit tests (TESTED / UNTESTED).</li>
<li>Where Lua-to-C++ type mismatches appeared (anchor setters expecting enum), updated Lua test code to map human-friendly strings to enum indices; considered adding C++ overloads for string names as a follow-up.</li>
</ul>
</li>
<li>Orphan / GC &amp; test utilities:<ul>
<li>Orphan retention and orphan_grace accessors are exposed to Lua and exercised by garbage‑collection tests; tests temporarily adjust orphanGrace (500ms) for deterministic verification and restore original value after the run.</li>
<li>Bound SDL.Delay to Lua and added small-step wait loops (Core:collectGarbage + SDL:Delay) used by GC tests for responsive detection.</li>
</ul>
</li>
<li>Stability &amp; validation:<ul>
<li>Rebuilt examples/test and ran the full test suite; all DisplayObject tests pass locally.</li>
<li>Cleaned up temporary diagnostic prints; kept controlled debug gating for registration and Lua tests.</li>
</ul>
</li>
<li><b>Performance Milestone:</b> <br  />
<ul>
<li>The <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> main loop is now 98% complete and matches the design for the finished library.</li>
<li>Benchmarks show well over 10,000 frames per second on development hardware. Roughly 6000-7000 fps on a 15 year old I3 system (roughly 1.5 miliseconds per frame of overhead).</li>
<li>The <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> API introduces only ~100 microseconds of overhead per frame, which is negligible for real-time 2D applications and 2D/3D games. This performance is without extensive post development optimization.</li>
<li>This validates the architectural choices and confirms that the system is ready for further feature development and integration.</li>
</ul>
</li>
<li><b>Milestone - DisplayObject Complete:</b> <br  />
<ul>
<li>With the DisplayObject (IDisplayObject) system now robust, unit-tested, and stable, the next major development track is the AssetObject system for resource management. <br  />
</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md375"></a>
[October 7, 2025]</h2>
<ul>
<li>cleaned up the heavy includes from the header files to reduce compile times and improve modularity.</li>
<li>Moved several implementation details from headers to source files, including private methods and member variables.</li>
<li>Reduced header dependencies by using forward declarations where possible.</li>
<li>Verified that all unit tests pass after the refactor.</li>
<li>Improved compile times by approximately 20% in the examples/test project.</li>
<li><span class="tt">SpriteSheet</span> refactor and Lua API changes:<ul>
<li>Added helpers to resolve/ensure the underlying SDL_Texture (resolve_texture / ensure_texture_loaded).</li>
<li>Reordered <span class="tt">drawSprite</span> APIs so spriteIndex is the first parameter for all C++ overloads and Lua wrappers.</li>
<li>Lua <span class="tt">drawSprite</span> wrappers accept (spriteIndex, x, y) or (spriteIndex, dstTable) and the extended variant expects spriteIndex immediately after the object (method call: ss:drawSprite_ext(idx, src, dst)).</li>
<li>Fixed all example call sites (<span class="tt">Box</span> and listener callbacks) to the new signature and dispatch patterns.</li>
</ul>
</li>
<li>Lua bindings and tests:<ul>
<li>Cleaned up Lua registration: removed onLoad/onUnload aliases from Lua handle surface; kept load/unload semantics.</li>
<li>Resolved Sol2 numeric/argument ordering issues in wrappers (fixed colon vs dot call mistakes).</li>
<li>Examples/test Lua callbacks updated and verified; drawSprite works in the onRender path.</li>
</ul>
</li>
<li>Build &amp; workflow notes:<ul>
<li>Prefer running builds from examples/test:<ul>
<li>./compile clean (full rebuild from examples/test)</li>
<li>./compile (incremental)</li>
<li>./prog (run test binary)</li>
</ul>
</li>
<li>Avoid requiring repository-root ./rebuild under other user permissions.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md377"></a>
[October 8, 2025]</h2>
<ul>
<li>drawSprite Lua API / overload consolidation<ul>
<li>Consolidated Lua drawSprite wrappers to a single exposed name with deterministic dispatch:<ul>
<li>Exposed variants (C++):<ul>
<li><span class="tt">drawSprite(index, x, y, color?, scaleMode?)</span> — fast (x,y) draw</li>
<li><span class="tt">drawSprite(index, dstRectF, color?, scaleMode?)</span> — destination-rect draw</li>
<li><span class="tt">drawSprite(index, srcRectF, dstRectF, color?, scaleMode?)</span> — source-&gt;dest subregion draw</li>
<li><span class="tt">scaleMode</span> may be string <span class="tt">"linear"</span> or <span class="tt">"nearest"</span> but <span class="tt">"nearest"</span> is default if omitted.</li>
</ul>
</li>
<li>Lua surface:<ul>
<li>Kept three explicit helpers for clarity: <span class="tt">drawSprite</span> (x,y form), <span class="tt">drawSprite_dst</span>, <span class="tt">drawSprite_ext</span></li>
<li>Also provide a single <span class="tt">drawSprite(...)</span> dispatcher that inspects argument types/tables and routes to the correct internal overload (heuristic rules documented below).</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Dispatcher rules (short):<ul>
<li>First argument after the handle must be spriteIndex (number).</li>
<li>(index, number, number, ...) → x,y form.</li>
<li>(index, table, table, ...) → srcTbl + dstTbl → drawSprite_ext.</li>
<li>(index, table, ...) → dstTbl → drawSprite_dst (if ambiguous, src+dst is preferred when two tables are provided).</li>
<li>Optional color table accepted as {r,g,b,a} or {r=..,g=..,b=..,a=..}; scaleMode accepted as string or numeric enum.</li>
<li>Optional rectangle tables accepted as {x=..,y=..,w=..,h=..} or {left=..,top=..,right=..,bottom=..}.</li>
<li>Callers may use explicit <span class="tt">drawSprite_dst</span> / <span class="tt">drawSprite_ext</span> to avoid ambiguity.</li>
</ul>
</li>
<li>Linear-filter "clipping" mitigation:<ul>
<li>When using "linear" (SDL_SCALEMODE_LINEAR) the renderer now insets source rectangles by ~0.5 texels to reduce neighbor-bleed.</li>
<li>Recommended long-term fixes: export atlas with duplicated-edge 1px padding or build a runtime padded atlas with edge replication (sketches available in the codebase).</li>
</ul>
</li>
<li>Docs &amp; examples updated:<ul>
<li>Example call sites in examples/test/lua/callbacks/listener_callbacks.lua updated to use explicit dst/ext forms or pass nil placeholders where appropriate.</li>
<li>Add unit tests for dispatcher patterns to prevent regressions.</li>
</ul>
</li>
<li>Label: wrapping, resource resolution, and rendering fixes<ul>
<li>Fixed Label word-wrapping bug: maxWidth computation now uses parent-relative coordinates so inset labels compute correct available width (previously produced one-word-per-line).</li>
<li>Standardized resourceName usage: Lua configs and InitStructs now reference the texture/spritesheet filename (e.g., "default_bmp_8x8"). Label defaults and example configs updated accordingly.</li>
<li>Relaxed Label constructor validation: accept SpriteSheet as deferred font source and perform strict IFontObject validation/loading in onInit(), avoiding premature hard-fails during config parsing.</li>
<li>Added guarded diagnostics for Label render/tokenization to aid debugging; diagnostics are temporary and gated for cleanup.</li>
<li>Verified fixes with the examples/test suite; Label rendering and wrapping now behave correctly in the blueishBox example.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md379"></a>
[October 9, 2025]</h2>
<ul>
<li>Codebase rename:<ul>
<li>DisplayObject -&gt; DisplayHandle and AssetObject -&gt; AssetHandle — completed across the C++ sources and Lua scripts.<ul>
<li>Renamed <span class="tt">DisplayObject</span> to <span class="tt">DisplayHandle</span> to help separate from the <span class="tt">IDisplayObject</span> and to imply <span class="tt">Handle</span> instead of <span class="tt">Object</span>.</li>
<li>Remamed <span class="tt">AssetObject</span> to <span class="tt">AssetHandle</span> to help separate fro the <span class="tt">IAssetObject</span> and to help imply <span class="tt">Handle</span> rather than <span class="tt">Object</span>.</li>
</ul>
</li>
<li>Lua bindings:<ul>
<li>per-instance and prototype handle bindings are registered; unit tests updated to use the new names.</li>
</ul>
</li>
<li>Remaining documentation work:<ul>
<li>diagrams, design charts and README references still use the old names and must be updated.</li>
</ul>
</li>
</ul>
</li>
<li><b>Initialization &amp; Property Audit:</b><ul>
<li>Audited all constructors (<span class="tt">InitStruct</span> and <span class="tt">sol::table</span>) for <span class="tt">IDisplayObject</span> and related types to ensure every property is initialized with sensible defaults.</li>
<li>Verified that all properties are exposed to Lua via <span class="tt">DisplayHandle</span> using the new identifier conventions (<span class="tt">snake_case</span> for properties, <span class="tt">lowerCamelCase</span> for functions).</li>
<li>Improved inheritance in Lua: derived types now inherit all properties and functions from <span class="tt">IDisplayObject</span>.</li>
<li>Updated Lua bindings to consistently use <span class="tt">snake_case</span> for properties and <span class="tt">lowerCamelCase</span> for functions.</li>
<li>Added and documented missing properties in constructors with clear comment blocks for maintainability.</li>
<li>Added helper lambdas and backward compatibility shims to ease migration to new naming conventions.</li>
<li>Updated documentation and README to clarify property/function naming conventions and inheritance expectations.</li>
<li>All changes verified by new Lua test scripts and unit tests; initialization bugs and missing bindings resolved.</li>
<li>All properties are now initialized in both constructors (<span class="tt">InitStruct</span> and <span class="tt">sol::table</span>).</li>
<li>Every property is exposed to Lua via <span class="tt">DisplayHandle</span> using the new identifier conventions.</li>
<li>Properties use <span class="tt">snake_case</span> and functions use <span class="tt">lowerCamelCase</span> in both C++ and Lua.</li>
<li>Inheritance is verified: derived types in Lua inherit all properties and functions from <span class="tt">IDisplayObject</span>.</li>
<li>Audit of constructors completed; missing properties added and documented with comment blocks.</li>
<li>All Lua bindings audited and updated; properties and functions bound with correct naming conventions.</li>
<li>Lua test scripts confirm inheritance and property/function access.</li>
<li>Documentation and code comments updated to reflect conventions and inheritance expectations.</li>
<li>Refactor for consistency completed; helper lambdas and backward compatibility shims added as needed.</li>
</ul>
</li>
<li><b>Startup Refactor</b><ul>
<li>SDOM’s startup logic has been refactored from legacy, implicit global table parsing (e.g., <span class="tt">Core</span> or <span class="tt">config</span>) to an explicit initialization pattern. Now, users must directly call <span class="tt">Core:create(config)</span> and <span class="tt">Core:run()</span> in both Lua and C++, separating configuration from resource creation and engine startup. This change improves clarity, flexibility, and maintainability, and aligns <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> with modern engine integration practices. Legacy support for global tables remains during the transition, but new documentation and examples use the explicit method calls.</li>
</ul>
</li>
<li><b>Key changes:</b><ul>
<li>Deprecate automatic parsing of global tables for startup.</li>
<li>Require explicit calls to <span class="tt">create</span> and <span class="tt">run</span> methods.</li>
<li>Separate config parsing from resource creation.</li>
<li>Bind engine functions as Lua globals for direct access.</li>
<li>Update all documentation and examples to reflect the new pattern.</li>
</ul>
</li>
<li><b>For full details and migration steps, see:</b> <a class="el" href="md_docs_2startup__refactor.html">docs/startup_refactor.md</a></li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md381"></a>
[October 11, 2025]</h2>
<ul>
<li><b>BitmapFont &amp; TruetypeFont Resource Creation Improvements:</b><ul>
<li>Refactored resource creation so both BitmapFont and TruetypeFont assets can be registered via the config table or manual <span class="tt">createAsset()</span> calls.</li>
<li>Added automatic TruetypeFont asset creation: a single <span class="tt">createAsset("TruetypeFont", { ... })</span> call now creates the backing TTFAsset internally if needed, simplifying Lua and C++ workflows.</li>
<li>Normalized resource type strings and property names (e.g., <span class="tt">"TruetypeFont"</span> and <span class="tt">"truetype"</span> both accepted; <span class="tt">font_size</span>/<span class="tt">fontSize</span>/<span class="tt">size</span> all mapped).</li>
<li>Improved BitmapFont creation: SpriteSheet and Texture dependencies are resolved automatically, and renderer initialization order is guaranteed.</li>
<li>Verified that config-driven and manual asset creation paths now work identically for all supported font types.</li>
</ul>
</li>
<li><b>Debug &amp; Logging Cleanup:</b><ul>
<li>Removed noisy debug prints and gated diagnostics behind <span class="tt"><a class="el" href="SDOM_8hpp.html#a21a2c7330a04ac78200a986f66609369" title="Logs a debug message in green text.">DEBUG_LOG</a></span> and <span class="tt"><a class="el" href="SDOM_8hpp.html#ab7cd931b0d8c1fe11b846eb779bfafba">DEBUG_LUA_TESTS</a></span> macros.</li>
<li>Silenced duplicate-config and asset re-registration messages for clean production output.</li>
<li>Added a config flag to enable resource creation diagnostics for troubleshooting.</li>
<li>Rebuilt and validated the codebase after cleanup; all tests pass.</li>
</ul>
</li>
<li><b>Label Rendering &amp; Font Scaling Fixes:</b><ul>
<li>Cleaned up label rendering logic to properly handle resizing, bounds, and culling.</li>
<li>Improved word wrapping and text alignment for both BitmapFont and TruetypeFont labels.</li>
<li>Verified per-axis bitmap font scaling and Truetype font size propagation.</li>
<li>Updated unit tests and example configs to confirm correct rendering and resource usage.</li>
</ul>
</li>
<li><b>TruetypeFont Implementation:</b><ul>
<li>Hardened TTFAsset and TruetypeFont loading, including SDL_ttf initialization and error handling.</li>
<li>Factory now exposes a <span class="tt">default_ttf</span> font and falls back to bitmap fonts if Truetype creation fails.</li>
<li>Fixed asset registration and loading bugs; all assets are now tracked and validated by the Factory.</li>
<li>Added integration points for future unit tests covering TTFAsset and TruetypeFont.</li>
</ul>
</li>
<li><b>Label Render-to-Texture Optimization:</b><ul>
<li>Refactored Label to render text to a cached texture when dirty, dramatically improving performance.</li>
<li>Labels now only re-rasterize text when text, font, style, or bounds change; otherwise, the cached texture is reused for fast redraws.</li>
<li>Average frame rate increased from ~100 fps to over 4000 fps in typical scenes (on this 15 year old machine).</li>
<li>Even under stress (continually forcing retokenization and redraws), frame rates remain high (~2000 fps), confirming the effectiveness of the optimization.</li>
<li>This change enables smooth rendering of large text blocks and many Labels without CPU/GPU bottlenecks.</li>
<li>Debug logic for texture rebuilds and alignment is now gated and can be toggled for future troubleshooting.</li>
<li>All unit tests and example scenes validated after the optimization.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md383"></a>
[October 12, 2025]</h2>
<ul>
<li><b>Internal Resource Renaming:</b><ul>
<li>Renamed all default internal resources for clarity and consistency:<ul>
<li><span class="tt">default_bmp_8x8</span> → <span class="tt">internal_font_8x8</span></li>
<li><span class="tt">default_bmp_8x12</span> → <span class="tt">internal_font_8x12</span></li>
<li><span class="tt">default_icon_8x8</span> → <span class="tt">internal_icon_8x8</span></li>
<li><span class="tt">default_ttf</span> → <span class="tt">internal_ttf</span></li>
</ul>
</li>
<li>Updated all config files, asset registration, and code references to use the new names.</li>
<li>This change makes it clear which resources are engine-provided and improves naming consistency across bitmap and truetype fonts.</li>
</ul>
</li>
<li><b>BitmapFont Sizing Fixes:</b><ul>
<li>BitmapFont assets now correctly default to their backing SpriteSheet's sprite size when <span class="tt">font_width</span> or <span class="tt">font_height</span> are not specified.</li>
<li>Both internal and external bitmap fonts render at their intended glyph dimensions (e.g., 8x12 for <span class="tt">internal_font_8x12</span>).</li>
<li>Added runtime diagnostics to confirm font metrics during asset loading.</li>
</ul>
</li>
<li><b>Label Rendering Improvements:</b><ul>
<li>Label logic now always renders at least one line or token, even when the available height or width is too small to fit the full content.</li>
<li>Prevents labels from disappearing when their bounds are smaller than the text, ensuring clipped text is still visible.</li>
<li>Verified that Labels handle extreme resizing gracefully, maintaining visibility of partial text.</li>
</ul>
</li>
<li><b>Tab Key Navigation Fixes:</b><ul>
<li>keyboard [TAB] and [SHIFT_TAB] were hitting on labels.</li>
<li>The <span class="tt">tab_enabled</span> and <span class="tt">tab_priority</span> properties are now working as expected. <span class="tt">Labels</span> are now not tab stops by default.</li>
</ul>
</li>
<li><b>Event Hit-Testing Fix:</b><ul>
<li>Fixed bug in EventManager::findTopObjectUnderMouse: the hidden-state check now uses the current node (<span class="tt">node.isHidden()</span>) instead of <span class="tt">rootNode</span>, and selection tie-breaks are deterministic.</li>
<li>Selection now uses a stable lexicographic rule (z-order primary, depth secondary, traversal sequence tertiary) so the topmost clickable object under the mouse is chosen reliably.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md385"></a>
[October 13, 2025]</h2>
<ul>
<li><b>Added inline numeric style escapes to Label tokenization:</b><ul>
<li><span class="tt">[border=N]</span>, <span class="tt">[outline=N]</span>, <span class="tt">[pad=WxH]</span> / <span class="tt">[padding=WxH]</span>, <span class="tt">[dropshadow=X,Y]</span></li>
<li>Parser accepts optional spaces (e.g. <span class="tt">[border = 3]</span>, <span class="tt">[border=    3]</span>) and single-number shorthand for padding.</li>
<li>Implemented per-field stacks so nested tags restore previous values correctly.</li>
<li>Defensive numeric parsing (validated before stoi) to avoid exceptions.</li>
</ul>
</li>
<li><b>Tokenizer robustness and normalization:</b><ul>
<li>Centralized and normalized escape parsing (trimmed params, alias support for <span class="tt">pad</span>/<span class="tt">padding</span>).</li>
<li>Ensured numeric forms have precedence where appropriate while preserving existing color/escape semantics.</li>
</ul>
</li>
<li><b>Color palette and mapping updates:</b><ul>
<li>Added <span class="tt">md_gray</span> (102) to complete the 6-step grayscale ramp.</li>
<li>Extended color map with many named colors (tan, orange, brown, gold, bronze, lime, mint, sea_green, royal_blue, etc.).</li>
<li>Documented named colors and hex escapes (<span class="tt">[RGB=rrggbb]</span>, <span class="tt">[RGBA=rrggbbaa]</span>) in <a class="el" href="label__text__parsing_8md.html">label_text_parsing.md</a>.</li>
</ul>
</li>
<li><b>Tests:</b><ul>
<li>Implemented Label_test1() to validate internal resources created.</li>
<li>Implemented Label_test2() to validate SpriteSheet/BitmapFont asset existence and metrics</li>
<li>Implemented Label_test3() to validate SpriteSheet/BitmapFont asset existence and metrics (LUA)</li>
<li>Implemented Label_test4() to validate Label word/phrase style flags tokenization and inspection</li>
<li>Implemented Label_test5() to validate numeric-style escapes (border/outlines/padding/dropshadow) via Lua unit test.</li>
<li>Implemented Label_test6() to validate color-target escapes (<span class="tt">[fgnd=]</span>, <span class="tt">[bgnd=]</span>, <span class="tt">[border=]</span>, <span class="tt">[outline=]</span>, <span class="tt">[shadow=]</span>) using named and hex colors.</li>
<li>Built and ran the test suite; label-related tests (including new tests) passed locally.</li>
<li><b>ToDo:</b><ul>
<li>Add unit tests for malformed/edge-case escapes (invalid hex, missing params, negative values).</li>
</ul>
</li>
</ul>
</li>
<li><b>IPanelObject</b><ul>
<li><span class="tt">IPanelObject</span> has an interface and basic implementation. Lua bindings are attached to <span class="tt">DisplayHandle</span>.</li>
</ul>
</li>
<li><b>Docs and cleanup:</b><ul>
<li>Updated <a class="el" href="label__text__parsing_8md.html">docs/label_text_parsing.md</a> with numeric escape syntax, semantics, examples, and the full color list.</li>
<li>Removed debug prints and cleaned up temporary diagnostics used during development.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md387"></a>
[October 14, 2025]</h2>
<ul>
<li>Added <span class="tt">Frame</span> scaffolding and registered the <span class="tt">Frame</span> DOM type with the Factory; <a class="el" href="SDOM__Frame_8cpp.html">SDOM_Frame.cpp</a> implements minimal constructors and defers behavior to <span class="tt">IPanelObject</span>.</li>
<li><span class="tt">IPanelObject</span>:<ul>
<li>Improved icon resource resolution (try configured name, then "&lt;name&gt;_SpriteSheet" fallback).</li>
<li>Removed temporary debug spam and added clearer, gated diagnostics.</li>
</ul>
</li>
<li><span class="tt">SpriteSheet</span> loader: accepts snake_case keys (<span class="tt">sprite_width</span> / <span class="tt">sprite_height</span>) from Lua in addition to camelCase.</li>
<li>Fonts &amp; BitmapFont defaults:<ul>
<li>Added <span class="tt">IFontObject::applyBitmapFontDefaults(...)</span> to populate missing <span class="tt">font_size</span>/<span class="tt">font_width</span>/<span class="tt">font_height</span> from a referenced <span class="tt">BitmapFont</span> asset.</li>
<li>Button/Group/Label now treat absent font metrics as unspecified and inherit BitmapFont metrics (e.g., external 8x12 fonts render at 8x12 without explicit metrics).</li>
</ul>
</li>
<li><span class="tt">Button</span>:<ul>
<li>Lua ctor applies <span class="tt">text</span> and font properties (<span class="tt">font_size</span>/<span class="tt">font_width</span>/<span class="tt">font_height</span>/<span class="tt">font_resource_name</span>), accepts common aliases, and preserves unspecified metrics for defaulting.</li>
<li>Exposed <span class="tt">getLabelObject()</span> to Lua via the <span class="tt">DisplayHandle</span> as the read-only <span class="tt">label</span> property.</li>
<li>Documented and validated <span class="tt">addEventListener</span> Lua usage (table form <span class="tt">{ type = EventType.X, listener = fn }</span>); example listeners switch root stages.</li>
</ul>
</li>
<li><span class="tt">Group</span>:<ul>
<li>Label creation uses font-type-aware glyph metrics (Bitmap sprite height or TrueType ascent) and centers the label over the top line of the group using the panel icon height.</li>
</ul>
</li>
<li>Lua config/tests:<ul>
<li>External <span class="tt">SpriteSheet</span> resource creation and usage verified (<span class="tt">external_icon_8x8</span> resolves and is used as Frame icon).</li>
<li>Example button listeners wired to switch stages; both synthetic and real mouse events exercise listeners successfully.</li>
</ul>
</li>
<li>Misc:<ul>
<li>Centralized keyboard focus pulsing rectangle in <span class="tt">Core</span> update/render logic.</li>
<li>Removed temporary diagnostics after verification; left gated INFO logs for troubleshooting.</li>
<li>Moved the various colors from <span class="tt">Label</span> to <span class="tt">IDisplayObject</span> as they are useful in places other than <span class="tt">Label</span>.</li>
<li>IconButton &amp; Checkbox:<ul>
<li>Added a lightweight <span class="tt">IconButton</span> display object that renders a single sprite index from a spritesheet and exposes IconIndex constants to Lua (IconIndex table + IconButton class constants).</li>
<li>IconIndex mapping centralized (enum ↔ name) and registered early in <span class="tt">Core</span> so Lua configs can reference <span class="tt">IconIndex.{index}</span> during startup.</li>
<li><span class="tt">IconButton</span> provides safe accessors (getIconIndex/setIconIndex, getSpriteSheetHandle/getSpriteSheet) to avoid leaking internals.</li>
<li><span class="tt">Checkbox</span> now composes an <span class="tt">IconButton</span> for the glyph; <span class="tt">setChecked()</span> updates the child icon index and queues a <span class="tt">StateChanged</span> event (payload includes previous/new state). Asset loading is handled by the Factory at creation so icons are ready before first render.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md389"></a>
[October 15, 2025]</h2>
<ul>
<li><b>Library Maintenance</b><ul>
<li>Cleaned up both system and local installs of the <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> API library.</li>
<li>Removed deprecated headers and binaries from <span class="tt">/usr/include/SDOM</span>, <span class="tt">/usr/local/include/SDOM</span>, and $HOME..<span class="tt">'.local/include/SDOM</span>.</li>
<li>Rebuilt and reinstalled the library to ensure only current headers and binaries are present.</li>
<li>Fully removed the deprecated <span class="tt">TriStateCheckbox</span>, <span class="tt">Checkbox</span>, and <span class="tt">Radiobox</span> objects; they have been replaced by the new <span class="tt">TristateButton</span>, <span class="tt">CheckButton</span>, and <span class="tt">RadioButton</span> implementations.</li>
</ul>
</li>
<li><b>UI controls:</b><ul>
<li>Added <span class="tt">CheckButton</span> as a descendant of <span class="tt">TristateButton</span>. <span class="tt">Checkbox</span> is now removed.</li>
<li>Added <span class="tt">RadioButton</span> as a descendant of <span class="tt">TristateButton</span>. <span class="tt">Radiobox</span> is now removed.</li>
<li>All button-like controls now use a unified state machine and expose consistent Lua APIs for state and interaction.</li>
<li><span class="tt">CheckButton</span> and <span class="tt">RadioButton</span> accept multiple state aliases in Lua (e.g., <span class="tt">is_checked</span>, <span class="tt">checked</span>, <span class="tt">is_selected</span>, <span class="tt">selected</span>).</li>
<li>Exposed <span class="tt">text</span> property for <span class="tt">Button</span>, <span class="tt">RadioButton</span>, and <span class="tt">CheckButton</span> to Lua so label text can be read/modified from scripts.</li>
<li><b>IButtonObject refactor and expansion:</b><ul>
<li>Expanded <span class="tt">IButtonObject</span> to better support future button objects (<span class="tt">IconButton</span>, <span class="tt">CheckButton</span>, <span class="tt">RadioButton</span>, <span class="tt">TristateButton</span>, <span class="tt">ArrowButton</span>, etc.).</li>
<li>Centralized logical state management using the <span class="tt">ButtonState</span> enum with canonical names and aliases (e.g., <span class="tt">Inactive</span>, <span class="tt">Active</span>, <span class="tt">Mixed</span>, <span class="tt">Disabled</span> and their synonyms).</li>
<li>Added mouse-hovered and key-focused flags to the interface for consistent UI state tracking.</li>
<li>Implemented static, idempotent <span class="tt">registerLuaBindings(sol::state_view lua)</span> method to expose <span class="tt">ButtonState</span> constants, conversion helpers, and DisplayHandle-level accessors (<span class="tt">getState</span>, <span class="tt">setState</span>, <span class="tt">isMouseHovered</span>, <span class="tt">setMouseHovered</span>, <span class="tt">isKeyFocused</span>, <span class="tt">setKeyFocused</span>) to Lua.</li>
<li>Ensured Lua bindings are reentrant and safe for multiple inheritance scenarios (e.g., CheckButton and RadioButton inheriting from TristateButton).</li>
<li>Updated derived controls to call <span class="tt">IButtonObject::registerLuaBindings(lua)</span> in their own Lua registration methods.</li>
<li><b>Bug fix:</b> Resolved an issue in <span class="tt">TristateButton</span> where state updates were not reflected correctly. The control was using its own state variable instead of the base object's <span class="tt">buttonState_</span>. Now all state logic is unified and works as expected.</li>
</ul>
</li>
</ul>
</li>
<li><b>Fonts &amp; labels:</b><ul>
<li>Finalized <span class="tt">IFontObject</span> improvements: <span class="tt">applyBitmapFontDefaults(...)</span> fills missing <span class="tt">font_size</span>/<span class="tt">font_width</span>/<span class="tt">font_height</span> from a referenced <span class="tt">BitmapFont</span> asset.</li>
<li><span class="tt">Label</span> and label-creating parents (<span class="tt">Button</span>, <span class="tt">Group</span>) now detect font type (Bitmap vs Truetype), adopt the font's type/metrics, and preserve unspecified metrics so BitmapFont defaults apply correctly.</li>
<li>Added <span class="tt">label_color</span> parsing/aliases and thread-safe metric resolution so external 8x12 bitmap fonts render at 8x12 without explicit per-control metrics.</li>
</ul>
</li>
<li><b>Group label centering:</b><ul>
<li>Fixed Group label vertical placement: compute glyph height by font type (Bitmap sprite height or TrueType ascent), obtain panel icon height via <span class="tt">getIconHeight()</span>, and position the label so its vertical center aligns with the top-line center inside the icon glyphs.</li>
</ul>
</li>
<li><b>Button &amp; Lua bindings:</b><ul>
<li>Button Lua ctor applies <span class="tt">text</span> and font properties (<span class="tt">font_size</span>/<span class="tt">font_width</span>/<span class="tt">font_height</span>/<span class="tt">font_resource</span> aliases).</li>
<li>Exposed <span class="tt">getLabelObject()</span> to Lua as read-only <span class="tt">label</span> on the <span class="tt">DisplayHandle</span>.</li>
<li>Documented and validated <span class="tt">addEventListener</span> Lua usage (table form <span class="tt">{ type = EventType.X, listener = fn }</span>); example listeners switch root stages.</li>
</ul>
</li>
<li><b>EventType &amp; Lua robustness:</b><ul>
<li>Hardened <span class="tt">EventType</span> Sol2 registration with a static guard so the usertype/metatable is always registered exactly once (avoids intermittent sol2 userdata/table mismatches).</li>
<li>Fixed Lua registration ordering issues that could cause intermittent unit-test failures.</li>
</ul>
</li>
<li><b>Test harness &amp; stability:</b><ul>
<li>Made <span class="tt">examples/test/repeat_tests.sh</span> robust: captures program output when logs are not saved, safely handles missing log files, and reliably prints failing run output.</li>
<li>Verified stability with long runs: repeated harness exercised (200 runs) with 0 failures locally.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md391"></a>
[October 16, 2025]</h2>
<ul>
<li><b>ArrowButton</b><ul>
<li>Added <span class="tt">ArrowButton</span> as a descendant of <span class="tt">IconButton</span>.</li>
<li><span class="tt">ArrowButton</span> supports four directions (Up, Down, Left, Right) and two states (Active, Inactive).</li>
<li>Exposed <span class="tt">Direction</span> constants to Lua via <span class="tt">ArrowButton</span> class and <span class="tt">IconIndex</span> table.</li>
<li>Implemented safe accessors (<span class="tt">getDirection</span>/<span class="tt">setDirection</span>) and state management.</li>
<li>Added Lua bindings for <span class="tt">ArrowButton</span>, including constructors and property accessors.</li>
</ul>
</li>
<li><b>IRangeControl</b><ul>
<li>Added <span class="tt">IRangeControl</span> interface to support range-based controls (ProgressBar, Slider, Scrollbar).</li>
<li><span class="tt">IRangeControl</span> defines properties: <span class="tt">min</span>, <span class="tt">max</span>, <span class="tt">value</span>, <span class="tt">orientation</span> (horizontal/vertical), and events (<span class="tt">onValueChanged</span>).</li>
<li>Implemented static <span class="tt">registerLuaBindings(sol::state_view lua)</span> method to expose <span class="tt">Orientation</span> constants and accessors (<span class="tt">getMin</span>, <span class="tt">setMin</span>, <span class="tt">getMax</span>, <span class="tt">setMax</span>, <span class="tt">getValue</span>, <span class="tt">setValue</span>, <span class="tt">getOrientation</span>, <span class="tt">setOrientation</span>) to Lua.</li>
<li><span class="tt">horizontal</span> and <span class="tt">vertical</span> orientation constants are available in Lua via <span class="tt">IRangeControl.Orientation</span>.</li>
<li>Ensured Lua bindings are reentrant and safe for multiple inheritance scenarios.</li>
<li>Derived controls should call <span class="tt">SUPER::registerLuaBindings(lua)</span> in their own Lua registration methods.</li>
<li>Added a new <span class="tt">IRangeControl_scaffold</span> to assist in creating new <span class="tt">RangeControl</span> objects</li>
</ul>
</li>
<li><b><span class="tt">Slider</span>:</b><ul>
<li>Added <span class="tt">Slider</span> scaffolding as a descendant of <span class="tt">IRangeControl</span>.</li>
<li>Implemented minimal constructors and deferred behavior to <span class="tt">IRangeControl</span>.</li>
<li>Registered <span class="tt">Slider</span> DOM type with the Factory.</li>
<li>Both <span class="tt">horizontal</span> and <span class="tt">vertical</span> orientations are now being rendered with the default <span class="tt">internal_icon_8x8</span> SpriteSheet.</li>
<li>Added a new property <span class="tt">step</span> for quantization of value changes when using a keyboard.</li>
<li>When selected, <span class="tt">PgUP</span> and <span class="tt">PgDn</span> change value by step * 10.0. If step is continuous (0.0f) it is treated as 1.0f.</li>
<li>Holding <span class="tt">SHIFT</span> while scrolling with the mouse wheel has a similar effect as <span class="tt">PgUP</span> and <span class="tt">PgDN</span>.</li>
<li>When selected, <span class="tt">HOME</span> and <span class="tt">END</span> set value to min or max as would be most relevant by orientation.</li>
<li>Slider knob and track are visually represented and mouse based interaction logic is functioning.</li>
<li>Slider emits <span class="tt">onValueChanged</span> events when the value changes.</li>
<li>Slider does expose <span class="tt">min</span>, <span class="tt">max</span>, <span class="tt">value</span>, and <span class="tt">orientation</span> properties to Lua.</li>
</ul>
</li>
<li><b><span class="tt">ProgressBar</span>:</b><ul>
<li>ProgressBar has been implimented as a read only range control. <br  />
</li>
<li>It supports both <span class="tt">vertical</span> and <span class="tt">horizontal</span> <span class="tt">Orientation</span>s.</li>
<li><span class="tt">setValue()</span> has been exposed to C++ and Lua.</li>
</ul>
</li>
<li><b>Defaults Forwarding:</b><ul>
<li>Implemented defaults-forwarding across the display/control constructors: Added/used defaults-aware base parsing (IDisplayObject(..., defaults) and IRangeControl(..., defaults)). Updated derived Lua ctors to forward their InitStruct() so derived defaults are visible during base parsing.</li>
<li>Controls updated (defaults forwarded): Slider, Box, Label, Frame, Group, Button, IconButton, CheckButton, RadioButton, TristateButton, ArrowButton, Stage, and IRangeControl_scaffold.</li>
<li>Removed local post-constructor color/Init fixes where forwarding made them redundant.</li>
<li>Added example/comment to SDOM_IRangeControl_scaffold showing the forwarding pattern and CreateFromLua example.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md393"></a>
[October 17, 2025]</h2>
<ul>
<li><b>ScrollBar:</b><ul>
<li>Added <span class="tt">ScrollBar</span> scaffolding as a descendant of <span class="tt">IRangeControl</span>.</li>
<li>Implemented minimal constructors and deferred behavior to <span class="tt">IRangeControl</span>.</li>
<li>Registered <span class="tt">ScrollBar</span> DOM type with the Factory.</li>
<li>Both <span class="tt">horizontal</span> and <span class="tt">vertical</span> orientations are now being rendered with the default <span class="tt">internal_icon_8x8</span> SpriteSheet.</li>
<li>Composes <span class="tt">ArrowButton</span>s for increment/decrement controls and a <span class="tt">ThumbTrack</span> with a draggable <span class="tt">Thumb</span>.</li>
<li>Supports both <span class="tt">vertical</span> and <span class="tt">horizontal</span> <span class="tt">Orientation</span>s.</li>
<li><b>Now supports alternate icon sprite sizes:</b> ScrollBar can use any registered SpriteSheet (e.g., 8x8, 12x12, 16x16), and the thumb and track are positioned and scaled correctly for all sizes.</li>
</ul>
</li>
<li><b>Slider:</b><ul>
<li>Added <span class="tt">Slider</span> scaffolding as a descendant of <span class="tt">IRangeControl</span>.</li>
<li>Registered <span class="tt">Slider</span> DOM type with the Factory.</li>
<li>Both <span class="tt">horizontal</span> and <span class="tt">vertical</span> orientations are now rendered with the default <span class="tt">internal_icon_8x8</span> SpriteSheet.</li>
<li>Added a <span class="tt">step</span> property for quantized value changes (keyboard and mouse wheel).</li>
<li>Slider knob and track are visually represented and mouse-based interaction logic is functioning.</li>
<li>Emits <span class="tt">onValueChanged</span> events when the value changes.</li>
<li><b>Now supports alternate icon sprite sizes:</b> Slider can use any registered SpriteSheet (e.g., 8x8, 12x12, 16x16), and the knob and track are positioned and scaled correctly for all sizes.</li>
<li><b>Knob padding:</b> Introduced <span class="tt">kKnobPaddingFraction</span> to reduce the active size of the knob, ensuring the visible part of the knob sprite aligns with the rail ends even if the sprite has transparent padding.</li>
</ul>
</li>
<li><b>ProgressBar:</b><ul>
<li>Implemented as a read-only range control.</li>
<li>Supports both <span class="tt">vertical</span> and <span class="tt">horizontal</span> <span class="tt">Orientation</span>s.</li>
<li><span class="tt">setValue()</span> is exposed to C++ and Lua.</li>
<li><b>Now supports alternate icon sprite sizes:</b> ProgressBar can use any registered SpriteSheet (e.g., 8x8, 12x12, 16x16), and the bar and track are positioned and scaled correctly for all sizes.</li>
</ul>
</li>
<li><b>IconButton and ArrowButton</b><ul>
<li>Both are now scaling to width and height.</li>
<li><span class="tt">IconButton</span> now correctly uses the proper icon SpriteSheet,</li>
<li>The <span class="tt">border</span> flag doesnt seem to have any effect on <span class="tt">IconButton</span> based objects.<ul>
<li>Check with <span class="tt">border_color</span> and <span class="tt">background_color</span> these should work with <span class="tt">IconButton</span> objects</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md395"></a>
[October 18, 2025]</h2>
<ul>
<li><b>Universally support multiple icon set sizes:</b><ul>
<li>Refactored <span class="tt">IPanelObject</span> to properly render different sized icon SpriteSheet assets.</li>
<li><span class="tt">Button</span>, <span class="tt">IconButton</span>, and <span class="tt">Frame</span> now make use of multi-sized <span class="tt">SpriteSheets</span> like the <span class="tt">RangeControls</span> now do.</li>
<li><span class="tt">Checkbox</span> and <span class="tt">Radiobox</span> now make use of multi-sized <span class="tt">SpriteSheets</span> like the <span class="tt">RangeControls</span> now do.</li>
</ul>
</li>
<li><b>UnitTest Refactoring:</b><ul>
<li>Refactored <span class="tt">SpriteSheet_UnitTests</span> to utilize proper scaffolding patterns.</li>
<li>Refactored <span class="tt">GarbageCollection_UnitTests</span> to utilize proper scaffolding patterns.</li>
<li>Refactored <span class="tt">Event_UnitTests</span> to utilize proper scaffolding patterns.</li>
<li>Refactored <span class="tt">EventType_UnitTests</span> to utilize proper scaffolding patterns.</li>
<li>Refactored <span class="tt">DisplayHandle_UnitTests</span> to utilize proper scaffolding patterns.</li>
<li>Refactored <span class="tt">Lua_UnitTests</span> to utilize proper scaffolding patterns.</li>
</ul>
</li>
<li><b>Border and Background Flags:</b><ul>
<li>moved to <span class="tt">IDisplayObject</span> with accessors <span class="tt">getBorder()</span> and <span class="tt">getBackground()</span> as getters and <span class="tt">setBorder()</span> and s<span class="tt">etBackground()</span> as mutators,</li>
<li>Properties are likewise <span class="tt">border</span> and <span class="tt">background</span> in Lua.</li>
</ul>
</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md397"></a>
[October 19, 2025]</h3>
<p><b>- Implemented per-type Lua binding registry and dispatcher:</b> <br  />
</p><ul>
<li>Added <span class="tt">DisplayHandle::ensure_type_bind_table(...)</span> and a <span class="tt">SDOM_Bindings</span> registry.<ul>
<li><span class="tt">DisplayHandle</span> now routes lookups to per-type binding tables via a <span class="tt">__index</span> dispatcher.</li>
</ul>
</li>
<li>Migrated <span class="tt">Group::_registerLuaBindings</span> to register into the <span class="tt">Group</span> per-type table (demo migration).</li>
<li>Completed per-item (per-type) binding migration for <span class="tt">Label</span>:<ul>
<li>Moved <span class="tt">Label</span>-specific bindings into the <span class="tt">Label</span> per-type table.</li>
<li>Removed <span class="tt">Label</span> color properties from the handle surface and ensured <span class="tt">IDisplayObject</span> color accessors are authoritative.</li>
<li>Updated <span class="tt">Label</span> tokenization to consume <span class="tt">IDisplayObject</span> colors; <span class="tt">FontStyle</span> token tables continue to expose color data for tokens.</li>
<li>Ran examples/test unit suite — <span class="tt">Label</span>-related tests (<span class="tt">Label_test6</span>, <span class="tt">Label_test10</span>, <span class="tt">Label_test11</span>) now pass locally.</li>
</ul>
</li>
<li>Reverted temporary debug prints and cleaned up diagnostic logging introduced during investigation.</li>
<li>Added a focused registration-order regression unit test (create + immediate method call) to catch userdata/binding order regressions; test added and executed locally.</li>
<li><b>Status</b>: <span class="tt">Group</span> and <span class="tt">Label</span> migrations complete; per-type binding dispatcher and fallback compatibility shims in place.</li>
<li><b>Next</b>: sweep remaining types (<span class="tt">Button</span>, <span class="tt">Frame</span>, <span class="tt">IconButton</span>, etc) to per-type tables, run full CI, and remove temporary backward-compatibility aliases where safe. All of the DisplayObjects will need to be swept to per-type tables and then fully tested with their own respective UnitTests.</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md399"></a>
[October 20, 2025]</h3>
<ul>
<li>Implemented a C++ per-type Lua binding registry (<span class="tt">LuaBindingRegistry</span>) and a small helper (<span class="tt">register_per_type</span>) to register protected functions reliably.</li>
<li>Updated <span class="tt">DisplayHandle</span> dispatcher to consult the C++ registry first, then fall back to the existing SDOM_Bindings per-type table and the minimal handle. This preserves backward compatibility while enabling deterministic, per-type dispatch.</li>
<li>Migrated <span class="tt">Label</span> and <span class="tt">Group</span> per-type bindings into the registry (also kept legacy table entries during transition) and adapted <span class="tt">IDisplayObject</span> bind helpers to use <span class="tt">register_per_type</span> where a per-type table exists.</li>
<li>Diagnosed and fixed the <span class="tt">Label</span>/<span class="tt">Group</span> font getter/setter issues (forwarding wrappers + registry adapters); rebuilt and ran the full test suite — unit tests pass.</li>
<li>Removed temporary debug prints added during investigation and replaced them with the plan to use gated debug macros if needed.</li>
<li>Added diagnostic helpers and registry dump facilities for incremental verification.</li>
<li><span class="tt">Next steps:</span> sweep remaining display object types (<span class="tt">Button</span>, <span class="tt">Frame</span>, <span class="tt">IconButton</span>, etc.) to <span class="tt">register_per_type</span>, enable strict registry-only lookup behind a runtime toggle, and add a small set of targeted migration tests to catch ordering/regression issues.</li>
<li>Now using SDOM_Core_LuaHelpers for registering Lua bindings in C++.<ul>
<li>We will be using this pattern going forward for all Lua binding registrations in C++.</li>
<li>_registerLuaBindings() will ultimately call into SDOM_Core_LuaHelpers to register the bindings to reduce excessive source file length.</li>
</ul>
</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md401"></a>
[October 21, 2025]</h3>
<ul>
<li><b>Major issues encountered with the dual Lua binding methodology</b><ul>
<li>Significant time spent attempting to maintain both per-item binding and fallback methods.</li>
<li>Decision made to refactor the Lua Binding System from the ground up:<ul>
<li>Removed the old per-type table binding system.</li>
<li>Removed the old fallback system—no compatibility shims remain.</li>
</ul>
</li>
<li>Began refactoring <span class="tt">Core</span> unit tests to use the new binding system. C++ tests are halfway completed.<ul>
<li>Completed <span class="tt">Scaffolding</span> tests.</li>
<li>Completed <span class="tt">Window Dimensions</span> tests.</li>
<li>Completed <span class="tt">Pixel Dimensions</span> tests.</li>
<li>Completed <span class="tt">Aspect Ratio Preservation</span> tests.</li>
<li>Completed <span class="tt">Texture Resize Allowance</span> tests.</li>
<li>Completed <span class="tt">Pixel Format</span> tests.</li>
<li>Completed <span class="tt">Renderer Logical Presentation</span> tests.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md403"></a>
[October 22, 2025]</h3>
<ul>
<li><b><span class="tt">Core_UnitTests</span> Refactor Progress:</b><ul>
<li>Continued refactoring <span class="tt">Core_UnitTests</span> to utilize the new Lua Binding System.<ul>
<li>Completed <span class="tt">Window Flags</span> tests.</li>
<li>Completed <span class="tt">Core Background Color</span> tests.</li>
<li>Completed <span class="tt">Factory Existence</span> tests.</li>
<li>Completed <span class="tt">Callback/Hook Registration</span> tests.</li>
<li>Completed <span class="tt">Stage/Root Node Management</span> tests.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md405"></a>
[October 23, 2025]</h3>
<ul>
<li><b><span class="tt">Core_UnitTests</span> Refactor Progress:</b><ul>
<li>Continued refactoring <b>Core_UnitTests</b> to utilize the new Lua Binding System.<ul>
<li>Completed <b>SDL Resource Accessors</b> tests.</li>
<li>Completed <b>Configuration Getters/Setters</b> tests.</li>
<li>Completed <b>Factory and Event Manager Access</b> tests.</li>
<li>Completed <b>Focus &amp; Hover Management</b> tests.</li>
<li>Completed <b>DisplayObject Creation</b> tests.</li>
</ul>
</li>
<li>Constructed a new lua based unit test scaffolding<ul>
<li>Started <b>Core_UnitTests.lua</b> based on the new lua test scaffolding.</li>
</ul>
</li>
</ul>
</li>
<li>Lua Binding System stabilization and test fixes<ul>
<li>Idempotent usertype registration: updated <b>register_usertype_with_table</b> to register once per Lua state and reuse the existing usertype table (no re‑registration/clobbering).</li>
<li>Safe table creation: <b>ensure_sol_table</b> now reuses existing global entries (usertype/table) and avoids replacing them, preventing stale userdatas.</li>
<li><b>DisplayHandle</b> minimal API + robust lookup: added <b>isValid</b>, <b>getName</b>, <b>getType</b>, <b>setName</b>, <b>setType</b>, and <b>get</b> with a resilient <b>__index</b> that supports both <span class="tt">:</span> and <span class="tt">.</span> calls.</li>
<li>Early/explicit registration: ensured <b>DisplayHandle</b> registration in <b>Core</b> and <b>Factory</b>, and before returning any handles from Core’s Lua helpers.</li>
<li>Handle return semantics: Core Lua wrappers now return <b>nil</b> (not an empty handle) when a requested object does not exist.</li>
</ul>
</li>
<li><b>IDisplayObject</b> bindings (available via <b>DisplayHandle</b>)<ul>
<li>Added generic hierarchy helpers: <b>addChild(childSpec)</b>, <b>removeChild(childSpec)</b>, <b>hasChild(childSpec)</b>, and <b>getChild(spec)</b> where specs accept a <b>DisplayHandle</b>, a name <b>string</b>, or **{ name = "..." }**`**.</li>
<li>Bound on both the <b>DisplayHandle</b> usertype and backing table for consistent lookup.</li>
</ul>
</li>
<li>Lua tests and scaffolding<ul>
<li><b>Core_UnitTests.lua</b> updated to verify <b>DisplayHandle</b> method availability, stage/root retrieval, invalid lookups returning <b>nil</b>, and basic parent/child operations.</li>
<li>Most Lua Integration checks are now passing after the binding fixes.</li>
</ul>
</li>
<li>IDE stubs<ul>
<li>Expanded <b>lua/api_stubs.lua</b> for better autocompletion: <b>DisplayHandle</b> methods above, partial <b>IDisplayObject</b> surface (add/remove/has/get child), and partial <b>Stage</b> (mouse getters/setters).</li>
</ul>
</li>
</ul>
<hr  />
 <h3 class="doxsection"><a class="anchor" id="autotoc_md407"></a>
[October 24, 2025]</h3>
<ul>
<li><p class="startli"><b>IDisplayObject_UnitTests</b> Refactor Progress:</p><ul>
<li>Began building a new <b>IDisplayObject_UnitTests.cpp</b> Unit Test Module to fully test all C++ and LUA properties and functions.</li>
<li>Implemented <b>IDisplayObject</b> Lua wrappers via <b>SDOM_IDisplayObject_LuaHelpers.hpp</b>.</li>
<li>Added Unit Tests for the following <b>IDisplayObject</b> Lua bindings:<ul>
<li><b>Dirty/State Management</b>:<ul>
<li>✅ cleanAll()</li>
<li>✅ getDirty()</li>
<li>✅ setDirty()</li>
<li>✅ isDirty()</li>
</ul>
</li>
<li><b>Debug/Utility</b>:<ul>
<li>✅ printTree()</li>
</ul>
</li>
<li><b>Events and Event Listener Handling</b>:<ul>
<li>✅ addEventListener(type, listener, useCapture, priority)</li>
<li>✅ removeEventListener(type, listener, useCapture)</li>
<li>✅ addEventListener_any(descriptor, maybe_listener, maybe_useCapture, maybe_priority)</li>
<li>✅ removeEventListener_any(descriptor, maybe_listener, maybe_useCapture)</li>
<li>✅ addEventListener_any_short(descriptor)</li>
<li>✅ removeEventListener_any_short(descriptor)</li>
<li>✅ hasEventListener(type, useCapture)</li>
<li>✅ queue_event(type, init_payload)</li>
</ul>
</li>
<li><b>Hierarchy Management</b>:<ul>
<li>✅ addChild(childSpec)</li>
<li>✅ getChild(spec)</li>
<li>✅ removeChild(childSpec)</li>
<li>✅ hasChild(childSpec)</li>
<li>✅ getParent()</li>
<li>✅ setParent(parentHandle)</li>
<li>✅ isAncestorOf(descendantSpec)</li>
<li>✅ isDescendantOf(ancestorSpec)</li>
<li>✅ removeFromParent()</li>
<li>✅ removeDescendant(descendantSpec)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="startli"><b>1. Event Lifecycle is Now Proven Correct</b></p><ul>
<li><b>Completed full event listener testing, including:</b><ul>
<li>Listener registration</li>
<li>Event queuing</li>
<li>Deferred dispatch via pumpEventsOnce()</li>
<li>Payload transfer</li>
<li>Listener removal</li>
<li>Re-check of listener presence</li>
</ul>
</li>
<li><b>This verifies:</b><ul>
<li>EventManager → Event dispatch → IDisplayObject listener flow works</li>
<li>Payloads survive through dispatch</li>
<li>Listeners are cleaned up correctly</li>
<li>No ghost callbacks / No leaks <br  />
</li>
</ul>
</li>
<li>This was one of the most critical pieces of the <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> runtime model — and it is now rock-solid.</li>
</ul>
<p class="startli"><b>2. Dirty-State System is Verified</b></p><ul>
<li>The dirty-propagation model behaved exactly as expected:<ul>
<li>Children do not dirty parents implicitly</li>
<li>setDirty() and cleanAll() work recursively</li>
<li>cleanAll() does not prematurely delete anything</li>
</ul>
</li>
<li>This confirms rendering invalidation strategy is correct and predictable. <br  />
</li>
</ul>
<p class="startli"><b>3. Hierarchy Management is Fully Validated</b></p><ul>
<li>The tests confirmed that:<ul>
<li>Child add/remove works in both handle and name forms</li>
<li>Parent references update properly</li>
<li>isAncestorOf / isDescendantOf logic is correct</li>
<li>removeFromParent() works safely</li>
<li>removeDescendant() works by both handle and name</li>
<li>Object lifetime remains fully owned by the Factory</li>
</ul>
</li>
<li>This is the backbone of the scene graph, and it's behaving exactly as a retained-mode UI should. <br  />
</li>
</ul>
<p class="startli"><b>4. Font &amp; SDL_TTF Cleanup Bug Resolved</b></p><ul>
<li>Tracked down a tricky issue:<ul>
<li>TTF_CloseFont() was being called twice</li>
<li>The real root cause was actually Lua closing before assets were destroyed</li>
<li>By removing manual lua_close(getLua()), the asset lifecycle now aligns correctly with shutdown</li>
</ul>
</li>
</ul>
</li>
<li><b>Valgrind Check:</b><ul>
<li>Ran Valgrind on the full test suite to check for memory leaks. <div class="fragment"><div class="line">LEAK SUMMARY:</div>
<div class="line">    definitely lost: 0 bytes</div>
<div class="line">    indirectly lost: 0 bytes</div>
<div class="line">    possibly lost: 0 bytes</div>
</div><!-- fragment --></li>
<li>Confirmed by "stress testing" (repeated test runs) that no leaks or crashes occur over the course of 2,000 iterations while running all current tests.</li>
<li>No memory leaks in neither the operating system nor the GPU memory. No invalid accesses detected.</li>
<li>The shutdown path is clean and deterministic — and Valgrind confirms it.</li>
<li>No heap creep. No GPU memory creep. No event buildup. No stale pointers. No race conditions.</li>
</ul>
</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md409"></a>
Next Steps:</h2>
<ul>
<li>Continue building out <b>Core_UnitTests.lua</b> to cover all Core methods and properties.</li>
<li>Continue building out <b>IDisplayObject_UnitTests.cpp</b> Unit Test Module to fully test all C++ and LUA properties and functions.</li>
</ul>
<hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md411"></a>
Long Term To Do:</h2>
<ul>
<li>Sweep all DisplayObjects to use the new Lua Binding System.</li>
<li>Update all Unit Tests to use the new Lua Binding System.<ul>
<li>Achieve full C++ test coverage for each DisplayObject type.</li>
<li>As the final C++ test, run a complete Lua file that mirrors the C++ tests to ensure parity.</li>
</ul>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md412"></a>
Current DisplayObject Inheritance Hierarchy:</h2>
<div class="fragment"><div class="line">─── IDisplayObject</div>
<div class="line">    ├── IPanelObject</div>
<div class="line">    │   ├── Button</div>
<div class="line">    │   ├── Frame</div>
<div class="line">    │   └── Group</div>
<div class="line">    ├── IRangeControl</div>
<div class="line">    │   ├── IRangeControl_scaffold</div>
<div class="line">    │   ├── ProgressBar</div>
<div class="line">    │   ├── ScrollBar</div>
<div class="line">    │   └── Slider</div>
<div class="line">    ├── IconButton</div>
<div class="line">    │   └── ArrowButton</div>
<div class="line">    ├── Label</div>
<div class="line">    ├── Stage</div>
<div class="line">    └── TristateButton</div>
<div class="line">        ├── CheckButton</div>
<div class="line">        └── RadioButton</div>
</div><!-- fragment --><hr  />
 <h2 class="doxsection"><a class="anchor" id="autotoc_md414"></a>
UnitTest Modules</h2>
<p>✅ Tests Verified 🔄 In Progress ☐ Pending</p><ul>
<li>☐ ArrowButton</li>
<li>☐ AssetHandle</li>
<li>☐ BitmapFont</li>
<li>☐ Button</li>
<li>☐ CheckButton</li>
<li>☐ <a class="el" href="classCLR.html" title="Static container for ANSI escape sequences and formatting helpers.">CLR</a></li>
<li>🔄 Core</li>
<li>☐ DisplayHandle</li>
<li>☐ Event</li>
<li>☐ EventManager</li>
<li>☐ EventType</li>
<li>☐ Factory</li>
<li>☐ Frame</li>
<li>☐ Group</li>
<li>☐ IAssetObject</li>
<li>☐ IButtonObject</li>
<li>☐ IconButton</li>
<li>☐ IDataObject</li>
<li>🔄 IDisplayObject</li>
<li>☐ IFontObject</li>
<li>☐ IPanelObject</li>
<li>☐ IRangeControl</li>
<li>☐ Label</li>
<li>☐ ProgressBar</li>
<li>☐ RadioButton</li>
<li>☐ ScrollBar</li>
<li>☐ Slider</li>
<li>☐ SpriteSheet</li>
<li>☐ Stage</li>
<li>☐ Texture</li>
<li>☐ TristateButton</li>
<li>☐ TruetypeFont</li>
<li>☐ TTFAsset </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<footer>
  <a href="#top">Back to top</a> &nbsp;|&nbsp; <a href="https://github.com/warte67/SDOM">Back to SDOM on GitHub</a>
</footer>
<script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ startOnLoad: true, theme: "neutral" });
</script>
