<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDOM - Simple SDL Document Object Model: Project Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SDOM - Simple SDL Document Object Model
   </div>
   <div id="projectbrief">A lightweight, extensible Document Object Model for SDL-based applications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_progress.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Project Description </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md110"></a></p>
<p>This project is a C++23 application utilizing SDL3 for graphical rendering and event handling. The goal is to create a simple Document Object Model (DOM) API for SDL3, focusing on building a GUI interface for SDL3 developers to use in their games or other cross-platform applications.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md111"></a>
Progress Updates</h1>
<ul>
<li><b>[July 2, 2025]</b> Initial rough draft and proof of concept.</li>
<li><b>[August 5, 2025]</b> <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> secondary rough draft</li>
<li><b>[September 19, 2025]</b><ul>
<li>Proof of concept approved. Main development approved. Work begins officially.</li>
<li>Improved Doxygen documentation for all major headers and macros.</li>
<li>Added and refined Doxygen comments for <a class="el" href="SDOM__CLR_8hpp.html" title="Static container for ANSI escape sequences for terminal text formatting and colorization.">SDOM_CLR.hpp</a>, <a class="el" href="SDOM_8hpp.html" title="Common include for SDOM-based projects. Defines macros and utilities.">SDOM.hpp</a>, and <a class="el" href="SDOM__IDataObject_8hpp.html">SDOM_IDataObject.hpp</a>.</li>
<li>Grouped and documented interface methods in SDOM_IDataObject for clarity and API usability.</li>
<li>Updated build script to run Doxygen from the correct folder, ensuring documentation builds reliably.</li>
<li>Fixed Doxyfile issues (footer path, PROJECT_BRIEF syntax) for clean documentation generation.</li>
<li>Validated Doxygen output for class, group, and member documentation.</li>
<li><span class="tt">IDataObject</span> designed. This base interface class handles JSON parsing and serialization.</li>
<li>Core class scaffold implemented as a thread-safe singleton.</li>
<li>Core initializes SDL, window, renderer, and texture with correct sizing and color from config.</li>
<li>Window and renderer display with correct logical size and background color.</li>
<li>Configuration via struct, JSON string, and JSON file is working and uses sensible defaults.</li>
<li>Main loop, event polling, and error handling are scaffolded and ready for extension.</li>
<li>Added six callback/hook registration methods to <span class="tt">Core</span>: <span class="tt">registerOnInit()</span>, <span class="tt">registerOnQuit()</span>, <span class="tt">registerOnUpdate()</span>, <span class="tt">registerOnEvent()</span>, <span class="tt">registerOnRender()</span>, <span class="tt">registerOnUnitTest()</span>.</li>
<li>Callbacks are invoked at the appropriate lifecycle and event points, enabling user-defined logic for initialization, quitting, updating, event handling, rendering, and unit testing.</li>
<li>Added <span class="tt">preserveAspectRatio</span> and <span class="tt">allowTextureResize</span> flags to <span class="tt">CoreConfig</span> for flexible window/texture resizing.</li>
<li>Window resizing now supports two modes: aspect ratio preservation and free resizing, controlled by config.</li>
<li>Texture resizing can be disabled via config, allowing fixed-resolution rendering regardless of window size.</li>
<li>JSON configuration supports both new flags for runtime flexibility.</li>
<li>Refined aspect ratio logic to use a static float for original aspect ratio, ensuring accuracy during repeated resizing.</li>
</ul>
</li>
<li><b>[September 20, 2025]</b><ul>
<li>Factory and resource_ptr scaffolding completed; code compiles and runs cleanly.</li>
<li>Event system foundation implemented and documented.</li>
<li>Doxygen documentation added for major interfaces (Core, Factory, IResourceObject).</li>
<li>Example usage of Core and Factory included in documentation.</li>
<li>Circular include and pointer management issues resolved (raw pointer for Factory ownership).</li>
<li>The <a class="el" href="namespaceSDOM.html" title="Contains all core classes and utilities for the SDOM library.">SDOM</a> framework now has a working Core singleton, Factory resource management, and resource_ptr smart handle. The codebase is stable, maintainable, and ready for expanded testing and feature development.</li>
</ul>
</li>
<li><b>[September 21, 2025]</b><ul>
<li>Renamed <span class="tt">resource_ptr</span> to <span class="tt">ResourceHandle</span> throughout the codebase for clarity.<ul>
<li>The new name better reflects its role as an opaque handle or key for resource lookup, rather than a smart pointer with ownership semantics.</li>
<li>Updated all documentation, examples, and comments to use <span class="tt">ResourceHandle</span>.</li>
</ul>
</li>
<li>Factory resource management and <span class="tt">ResourceHandle</span> logic fully tested and confirmed:<ul>
<li>Resources can be added, retrieved, and removed from the Factory.</li>
<li>Multiple <span class="tt">ResourceHandle</span> instances correctly reflect resource existence and become invalid after removal.</li>
<li>Type-safe access via <span class="tt">dynamic_cast</span> is working and robust.</li>
</ul>
</li>
<li>Debug output and test scaffolding added to verify resource lifetime and pointer behavior.</li>
<li>Resolved copy constructor and assignment operator issues for <span class="tt">ResourceHandle</span>.</li>
<li>Confirmed that the Factory now contains a working <span class="tt">Stage</span> resource.</li>
<li>Next step: Implement parent/child relationships for resources and display objects.</li>
<li>Unit test framework will be moved to <span class="tt">onUnitTest()</span> methods once implemented.</li>
<li><b>Resource Creation &amp; Initialization:</b><ul>
<li>Verified that resources (especially Stage) are created via the Factory and properly initialized with onInit().</li>
<li>Debug output confirms lifecycle methods (onInit, onQuit, onUpdate, onRender) are called for the root stage.</li>
</ul>
</li>
<li><b>Core &amp; Factory Integration:</b><ul>
<li>Ensured the root node (mainStage) is set and found by Core, with correct debug output.</li>
<li>Improved resource creation logic to always use Factory::create, guaranteeing initialization and registration.</li>
</ul>
</li>
<li><b>Recursive Traversal:</b><ul>
<li>Implemented and tested recursive lambdas for shutdown (onQuit) and unit testing (onUnitTest), with correct type handling and null checks.</li>
</ul>
</li>
<li><b>Bug Fixes &amp; Stability:</b><ul>
<li>Diagnosed and resolved segmentation faults by adding null checks and debug output.</li>
<li>Tested resource handles and pointer management are more robust and safer, but further testing may be required.</li>
</ul>
</li>
<li><b>Testing &amp; Debugging:</b><ul>
<li>Added debug prints to trace resource creation and lifecycle events.</li>
<li>Validated that the system is ready for expanded DOM tree parsing and more complex resource hierarchies.</li>
</ul>
</li>
</ul>
</li>
<li><b>[September 22, 2025]</b><ul>
<li><b>Unit Test Framework Refined:</b> <br  />
<ul>
<li>Simplified the unit test system: now every resource implements <span class="tt">onUnitTests()</span> for built-in tests.</li>
<li>External/custom unit tests are registered and run via the <span class="tt">registerOnUnitTest()</span> callback, keeping the API minimal and flexible.</li>
<li>Removed unnecessary callback registration logic from <span class="tt">IUnitTest</span>, relying on virtual methods and user callbacks for extensibility.</li>
</ul>
</li>
<li><b>Consistent Naming:</b> <br  />
<ul>
<li>Standardized all unit test-related identifiers to use the plural form (<span class="tt">Tests</span>) for clarity and consistency across the codebase.</li>
</ul>
</li>
<li><b>External Test Integration:</b> <br  />
<ul>
<li>Users no longer need to register callbacks for external unit tests. <br  />
</li>
<li>Instead, external unit test functions (like <span class="tt">Core_UnitTests()</span> and <span class="tt">Factory_UnitTests()</span>) are simply called directly from within the already established <span class="tt">registerOnUnitTest()</span> callback in <span class="tt">main.cpp</span>. <br  />
</li>
<li>This approach makes it straightforward to create and run custom unit tests or build a dedicated test application, while maintaining clear separation between built-in and user-defined tests.</li>
</ul>
</li>
<li><b>API Cleanup:</b> <br  />
<ul>
<li>Removed redundant or overly complex code from the unit test infrastructure.</li>
<li>Ensured the API remains clean, maintainable, and easy to extend.</li>
</ul>
</li>
<li><b>Debugging &amp; Issue Resolution:</b> <br  />
<ul>
<li>Diagnosed and resolved issues with singleton access, reference binding, and infinite recursion in callback registration.</li>
<li>Improved understanding of C++ function pointer and lambda usage for flexible test registration.</li>
</ul>
</li>
<li><b>Expanded Test Coverage:</b> <br  />
<ul>
<li>Added more unit tests for Factory, Stage, and display objects.</li>
<li>Confirmed that the unit test system works well for new features.</li>
<li>Identified the need for a custom test object (e.g., <span class="tt">Box</span>) to facilitate comprehensive anchoring and coordinate propagation tests.</li>
<li>Planned to add live event tests (drag/drop, deferred add/remove) and prioritize tests for new features as they are developed.</li>
<li>Recognized that coverage for older features will be expanded over time, focusing first on the most critical areas.</li>
</ul>
</li>
</ul>
</li>
<li><b>[September 23, 2025]</b><ul>
<li><b>Event System Preliminary Testing:</b> <br  />
<ul>
<li>Successfully integrated and tested the event system with live SDL3 events.</li>
<li>Verified that mouse, keyboard, window, and focus events are received and dispatched correctly.</li>
<li>Confirmed that custom display objects (Box) receive and handle events as expected.</li>
<li>Minimal "life tests" for event propagation and Box object interaction are passing.</li>
<li>Debug output confirms event flow from SDL3 through Core, EventManager, and into display objects.</li>
<li>Refactored event dispatch logic for single-stage architecture, simplifying code and improving maintainability.</li>
<li>Cleaned up circular includes and pointer conversion issues, improving build stability.</li>
<li>Next steps: Expand event tests for Box (drag/drop, stacking, anchoring), add more interactive unit tests, and document event system usage.</li>
<li>Refactored codebase to use new <span class="tt">DomHandle</span> and <span class="tt">ResHandle</span> types throughout.</li>
<li>Verified and debugged handle logic, ensuring safe pointer access and robust operator overloading.</li>
<li>Cleaned up event system: <span class="tt">EventManager</span> now fully leverages the handle system, removing unnecessary casts and improving safety.</li>
<li>Fixed segmentation faults and infinite recursion issues in tree traversal by clarifying handle usage and recursive logic.</li>
<li>Improved code readability and maintainability by removing legacy patterns and redundant checks.</li>
<li>All major event and display object interactions now use the new handle API.</li>
<li>Codebase is stable, with most reference and legacy issues resolved.</li>
</ul>
</li>
</ul>
</li>
<li><b>[September 24, 2025]</b><ul>
<li><b>Factory Refactor:</b></li>
<li>Completely revised the <span class="tt">Factory</span> to use <span class="tt">IDisplayObject</span> instead of <span class="tt">IResourceObject</span>.</li>
<li>Planned to reintroduce <span class="tt">IResourceObject</span> into the <span class="tt">Factory</span> later, ensuring compatibility with both resource and display object management.</li>
<li>Verified that the <span class="tt">Factory</span> now supports <span class="tt">IDisplayObject</span> creation and initialization.</li>
<li><b>Box Object:</b></li>
<li>The <span class="tt">Box</span> object is now fully functional, with lifecycle methods (<span class="tt">onInit</span>, <span class="tt">onRender</span>, <span class="tt">onUpdate</span>, etc.) implemented and tested.</li>
<li>Event listener functionality is the only remaining issue, with the <span class="tt">MouseClick</span> event listener not firing as expected.</li>
<li>Began troubleshooting the event listener system, focusing on event propagation, listener registration, and dispatch logic.</li>
<li><b>Event System:</b></li>
<li>Continued debugging and refining the event system to ensure proper propagation and listener execution.</li>
<li>Verified that <span class="tt">EventManager</span> correctly dispatches events to the stage and its children.</li>
<li>Added debug logs to trace event flow and identify potential issues with <span class="tt">Box</span> event handling.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md112"></a>
ToDo:</h1>
<ul>
<li>Resolve the <span class="tt">Box</span> event listener issue, ensuring that <span class="tt">MouseClick</span> events are received and processed correctly.</li>
<li>Expand event system tests to include drag-and-drop functionality, stacking, and anchoring for <span class="tt">Box</span> objects.</li>
<li>Reintroduce <span class="tt">IResourceObject</span> into the <span class="tt">Factory</span> for resource management alongside <span class="tt">IDisplayObject</span>.</li>
<li>Add unit tests for the revised <span class="tt">Factory</span> and event system to ensure stability and robustness.</li>
<li>Move resource and pointer tests to <span class="tt">onUnitTest()</span> methods when available.</li>
<li>Add comprehensive unit tests for Factory, resource_ptr, and error conditions.</li>
<li>Language Hooks<ul>
<li>Plan for hooks to support other languages (e.g., Python bindings).</li>
<li>Add placeholder comments or sections.</li>
</ul>
</li>
<li>Documentation<ul>
<li>Add Doxygen comments for all public API elements.</li>
<li>Update <a class="el" href="progress_8md.html">progress.md</a> with daily progress and ToDo items.</li>
</ul>
</li>
<li>Testing<ul>
<li>Add unit tests for macros and exception handling. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<footer>
  <a href="https://github.com/warte67/SDOM">Back to SDOM on GitHub</a>
</footer>
