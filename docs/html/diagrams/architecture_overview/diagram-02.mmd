sequenceDiagram
  autonumber
  participant Prog as examples/test/prog
  participant Core as SDOM::Core
  participant SDL as SDL3 Subsystem
  participant Factory as Factory
  participant Stage as Stage (Root)
  participant EM as EventManager

  Prog->>Core: configure(...)
  Prog->>Core: run()
  Core->>SDL: init window/renderer/texture
  Core->>Factory: ensure Stage type registered
  Core->>Factory: create<Stage>()
  Factory-->>Core: Stage instance
  Core->>Stage: onInit()
  loop Main Loop
    Core->>EM: poll/dispatch events
    EM->>Stage: propagate events (capture→target→bubble)
    Core->>Stage: onUpdate(dt)
    Core->>Stage: onRender()
  end
  Prog-->>Core: onQuit()
  Core->>SDL: shutdown
